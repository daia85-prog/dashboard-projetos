<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Infraestrutura v7.6</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        
        .container { max-width: 1400px; margin: 0 auto; background: white; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); overflow: hidden; }
        
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px 25px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; }
        .header-left h1 { font-size: 1.4em; margin-bottom: 5px; }
        .header-left p { opacity: 0.9; font-size: 0.85em; }
        
        .nav-buttons { display: flex; gap: 8px; flex-wrap: wrap; }
        .nav-btn { padding: 9px 16px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.85em; transition: all 0.2s; text-decoration: none; display: inline-flex; align-items: center; gap: 5px; color: white; }
        .nav-btn.green { background: #22c55e; }
        .nav-btn.green:hover { background: #16a34a; }
        .nav-btn.purple { background: #8b5cf6; }
        .nav-btn.purple:hover { background: #7c3aed; }
        .nav-btn.blue { background: #3b82f6; }
        .nav-btn.blue:hover { background: #2563eb; }
        
        .content { padding: 20px 25px; }
        
        .toggle { display: flex; justify-content: center; margin-bottom: 18px; }
        .toggle button { padding: 11px 28px; border: 2px solid #667eea; background: white; color: #667eea; font-weight: 600; cursor: pointer; transition: all 0.2s; font-size: 0.95em; }
        .toggle button:first-child { border-radius: 25px 0 0 25px; }
        .toggle button:last-child { border-radius: 0 25px 25px 0; border-left: none; }
        .toggle button.active { background: #667eea; color: white; }
        
        .phases-legend { background: #f1f5f9; padding: 10px 15px; border-radius: 8px; margin-bottom: 15px; font-size: 0.75em; color: #64748b; text-align: center; line-height: 1.8; }
        .phases-legend strong { color: #475569; }
        
        .filters { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px; margin-bottom: 18px; padding: 15px; background: #f8fafc; border-radius: 10px; align-items: end; }
        .filter-group label { display: block; font-size: 0.78em; color: #64748b; margin-bottom: 4px; font-weight: 500; }
        .filter-group input, .filter-group select { width: 100%; padding: 8px 10px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 0.9em; }
        
        .checkbox-group { display: flex; align-items: center; gap: 8px; padding: 8px 12px; background: #fef2f2; border: 2px solid #fca5a5; border-radius: 8px; cursor: pointer; }
        .checkbox-group input { width: 16px; height: 16px; cursor: pointer; }
        .checkbox-group span { font-size: 0.85em; color: #dc2626; font-weight: 600; }
        
        /* KPI Cards */
        .kpis { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 12px; margin-bottom: 20px; }
        .kpi { text-align: center; padding: 15px 10px; background: white; border-radius: 10px; border: 1px solid #e2e8f0; border-top: 4px solid #e2e8f0; }
        .kpi.verde { border-top-color: #22c55e; }
        .kpi.amarelo { border-top-color: #f59e0b; }
        .kpi.vermelho { border-top-color: #ef4444; }
        .kpi.azul { border-top-color: #3b82f6; }
        .kpi .num { font-size: 1.8em; font-weight: 700; color: #1e293b; }
        .kpi .lbl { font-size: 0.8em; color: #64748b; }
        
        /* Fase cards (Macro) - GRID LADO A LADO */
        .phases { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; }
        .phase-card { background: white; border: 1px solid #e2e8f0; border-radius: 10px; padding: 15px; border-top: 4px solid #e2e8f0; }
        .phase-card.verde { border-top-color: #22c55e; }
        .phase-card.amarelo { border-top-color: #f59e0b; }
        .phase-card.vermelho { border-top-color: #ef4444; }
        
        .phase-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px; }
        .phase-title-group { flex: 1; }
        .phase-title { font-weight: 700; color: #1e293b; font-size: 0.9em; display: block; margin-bottom: 3px; }
        .phase-count { font-size: 0.8em; color: #64748b; }
        .phase-alert { background: #fee2e2; color: #dc2626; padding: 3px 8px; border-radius: 10px; font-size: 0.7em; font-weight: 700; margin-left: 5px; }
        .phase-percent { font-size: 1.4em; font-weight: 700; }
        .phase-percent.verde { color: #22c55e; }
        .phase-percent.amarelo { color: #f59e0b; }
        .phase-percent.vermelho { color: #ef4444; }
        
        .phase-bar { height: 8px; background: #e2e8f0; border-radius: 4px; margin-bottom: 10px; overflow: hidden; }
        .phase-bar-fill { height: 100%; border-radius: 4px; }
        .phase-bar-fill.verde { background: #22c55e; }
        .phase-bar-fill.amarelo { background: #f59e0b; }
        .phase-bar-fill.vermelho { background: #ef4444; }
        
        .phase-context { font-size: 0.78em; padding: 6px 10px; border-radius: 6px; margin-bottom: 8px; }
        .phase-context.gray { background: #f1f5f9; color: #64748b; }
        .phase-context.warning { background: #fef3c7; color: #92400e; }
        .phase-context.danger { background: #fee2e2; color: #dc2626; }
        
        .phase-info { font-size: 0.8em; color: #64748b; margin-bottom: 8px; }
        .phase-projects { display: flex; flex-wrap: wrap; gap: 5px; }
        .badge { background: #e0e7ff; color: #4338ca; padding: 4px 10px; border-radius: 12px; font-size: 0.75em; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .badge:hover { background: #4338ca; color: white; }
        .badge.critico { background: #fee2e2; color: #dc2626; }
        .badge.critico:hover { background: #dc2626; color: white; }
        
        /* Project cards (Micro) - GRID */
        .projects { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 15px; }
        .project-card { background: white; border: 1px solid #e2e8f0; border-radius: 10px; padding: 15px; cursor: pointer; transition: all 0.2s; border-left: 4px solid #e2e8f0; }
        .project-card:hover { box-shadow: 0 5px 20px rgba(0,0,0,0.1); transform: translateY(-2px); }
        .project-card.verde { border-left-color: #22c55e; }
        .project-card.amarelo { border-left-color: #f59e0b; }
        .project-card.vermelho { border-left-color: #ef4444; }
        
        .project-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px; }
        .project-name { font-weight: 700; color: #1e293b; font-size: 1.1em; }
        .priority { padding: 3px 8px; border-radius: 4px; font-size: 0.7em; font-weight: 700; text-transform: uppercase; }
        .priority.alta { background: #fee2e2; color: #dc2626; }
        .priority.media { background: #fef3c7; color: #d97706; }
        .priority.baixa { background: #dcfce7; color: #16a34a; }
        
        .project-meta { display: flex; flex-wrap: wrap; gap: 12px; font-size: 0.82em; color: #64748b; margin-bottom: 10px; }
        
        .project-phase { background: #eff6ff; color: #1d4ed8; padding: 6px 10px; border-radius: 6px; font-size: 0.8em; margin-bottom: 6px; display: inline-block; }
        .project-next-phase { font-size: 0.75em; color: #64748b; margin-bottom: 10px; }
        .project-next-phase strong { color: #475569; }
        
        .project-dates { display: flex; gap: 12px; font-size: 0.8em; margin-bottom: 10px; color: #64748b; flex-wrap: wrap; }
        .project-dates .atrasado { color: #dc2626; font-weight: 600; }
        
        .progress { margin-bottom: 10px; }
        .progress-header { display: flex; justify-content: space-between; font-size: 0.85em; margin-bottom: 4px; }
        .progress-bar { height: 6px; background: #e2e8f0; border-radius: 3px; overflow: hidden; }
        .progress-fill { height: 100%; border-radius: 3px; }
        .progress-fill.verde { background: #22c55e; }
        .progress-fill.amarelo { background: #f59e0b; }
        .progress-fill.vermelho { background: #ef4444; }
        
        .project-footer { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 8px; }
        .status-badge { display: inline-block; padding: 4px 10px; border-radius: 5px; font-size: 0.75em; font-weight: 600; }
        .status-badge.concluido { background: #dcfce7; color: #166534; }
        .status-badge.em-andamento { background: #dbeafe; color: #1e40af; }
        .status-badge.aguardando { background: #fef3c7; color: #92400e; }
        .status-badge.nao-iniciado { background: #f3f4f6; color: #4b5563; }
        .status-badge.atrasado { background: #fee2e2; color: #991b1b; }
        
        .delay-badge { font-size: 0.75em; color: #dc2626; font-weight: 600; }
        
        .empty { text-align: center; padding: 40px; color: #64748b; }
        
        /* Modal */
        .modal-bg { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center; padding: 20px; }
        .modal-bg.show { display: flex; }
        .modal { background: white; border-radius: 12px; max-width: 750px; width: 100%; max-height: 85vh; overflow: hidden; }
        .modal-head { background: #667eea; color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; }
        .modal-head h2 { font-size: 1.1em; }
        .modal-head-btns { display: flex; gap: 8px; }
        .modal-close { background: rgba(255,255,255,0.2); border: none; color: white; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; font-size: 1.2em; }
        .modal-print-btn { background: #22c55e; border: none; color: white; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 0.85em; font-weight: 600; }
        .modal-print-btn:hover { background: #16a34a; }
        .modal-body { padding: 20px; max-height: calc(85vh - 60px); overflow-y: auto; }
        
        .modal-info { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #e2e8f0; }
        .modal-info-item { font-size: 0.85em; }
        .modal-info-item .label { color: #64748b; display: block; font-size: 0.85em; }
        .modal-info-item .value { color: #1e293b; font-weight: 600; }
        .modal-info-item .value.danger { color: #dc2626; }
        
        .modal-entrega { background: #eff6ff; border: 1px solid #bfdbfe; padding: 12px 15px; border-radius: 8px; margin-bottom: 15px; }
        .modal-entrega-title { font-size: 0.8em; color: #1d4ed8; font-weight: 600; margin-bottom: 5px; }
        .modal-entrega-content { font-size: 0.9em; color: #1e293b; }
        
        .summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 15px; }
        .summary-item { text-align: center; padding: 12px 8px; background: #f8fafc; border-radius: 8px; }
        .summary-item .num { font-size: 1.4em; font-weight: 700; }
        .summary-item .lbl { font-size: 0.75em; color: #64748b; }
        
        .activity-list { border: 1px solid #e2e8f0; border-radius: 8px; }
        .activity { display: grid; grid-template-columns: 1fr auto auto; gap: 10px; align-items: center; padding: 10px 12px; border-bottom: 1px solid #e2e8f0; cursor: pointer; transition: background 0.2s; }
        .activity:hover { background: #eff6ff; }
        .activity:last-child { border-bottom: none; }
        .activity:nth-child(even) { background: #f8fafc; }
        .activity:nth-child(even):hover { background: #eff6ff; }
        .activity-info { min-width: 0; }
        .activity-name { font-size: 0.9em; color: #1e293b; font-weight: 500; }
        .activity-fase { font-size: 0.75em; color: #64748b; }
        .activity-dates { font-size: 0.75em; color: #94a3b8; }
        .activity-resp { font-size: 0.75em; color: #64748b; text-align: right; min-width: 80px; }
        
        .timestamp { text-align: center; padding: 15px; color: #94a3b8; font-size: 0.8em; border-top: 1px solid #e2e8f0; margin-top: 20px; }
        
        /* Modal de Impress√£o/PDF */
        .print-modal { max-width: 500px; }
        .print-options { display: flex; flex-direction: column; gap: 10px; margin-bottom: 15px; }
        .print-option { display: flex; align-items: center; gap: 10px; padding: 12px 15px; background: #f8fafc; border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s; }
        .print-option:hover { border-color: #667eea; background: #f0f4ff; }
        .print-option.selected { border-color: #667eea; background: #eff6ff; }
        .print-option input[type="radio"] { width: 18px; height: 18px; cursor: pointer; }
        .print-option-text { flex: 1; }
        .print-option-title { font-weight: 600; color: #1e293b; font-size: 0.95em; }
        .print-option-desc { font-size: 0.8em; color: #64748b; margin-top: 2px; }
        
        .print-projects-list { max-height: 200px; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 8px; padding: 10px; margin-top: 10px; display: none; }
        .print-projects-list.show { display: block; }
        .print-project-item { display: flex; align-items: center; gap: 10px; padding: 8px; border-radius: 6px; cursor: pointer; }
        .print-project-item:hover { background: #f1f5f9; }
        .print-project-item input { width: 16px; height: 16px; }
        
        .print-buttons { display: flex; gap: 10px; margin-top: 20px; }
        .print-buttons button { flex: 1; padding: 12px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s; font-size: 0.95em; }
        .btn-execute { background: #667eea; color: white; }
        .btn-execute:hover { background: #5a67d8; }
        .btn-cancel { background: #e2e8f0; color: #475569; }
        .btn-cancel:hover { background: #cbd5e1; }
        
        /* Modal Atividade */
        .activity-modal { max-width: 500px; }
        .activity-detail { padding: 15px; background: #f8fafc; border-radius: 8px; margin-bottom: 15px; }
        .activity-detail-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #e2e8f0; }
        .activity-detail-row:last-child { border-bottom: none; }
        .activity-detail-label { color: #64748b; font-size: 0.9em; }
        .activity-detail-value { color: #1e293b; font-weight: 600; font-size: 0.9em; }
        .activity-history { margin-top: 15px; }
        .activity-history h4 { font-size: 0.95em; color: #1e293b; margin-bottom: 10px; }
        .activity-history-empty { text-align: center; padding: 20px; color: #94a3b8; font-size: 0.9em; background: #f8fafc; border-radius: 8px; }
        
        @media (max-width: 768px) {
            .header { flex-direction: column; text-align: center; }
            .filters { grid-template-columns: 1fr 1fr; }
            .phases { grid-template-columns: 1fr; }
            .projects { grid-template-columns: 1fr; }
            .summary { grid-template-columns: repeat(2, 1fr); }
            .kpis { grid-template-columns: repeat(2, 1fr); }
        }

        @media print {
            body { background: white !important; padding: 10px !important; }
            .container { box-shadow: none !important; max-width: 100% !important; }
            .nav-buttons, .toggle, .filters, .checkbox-group { display: none !important; }
            .header { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; padding: 15px !important; }
            .content { padding: 15px !important; }
            .kpi, .phase-card, .project-card { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; border: 1px solid #e2e8f0 !important; break-inside: avoid !important; }
            .phase-bar-fill, .progress-fill { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
        }
    </style>
</head>
<body>
    <div class="container" id="mainContainer">
        <header class="header">
            <div class="header-left">
                <h1>üìä Dashboard de Infraestrutura</h1>
                <p>Gest√£o de Projetos | Invent Corp</p>
            </div>
            <nav class="nav-buttons">
                <a href="view-projetos.html" class="nav-btn blue">üìä Alertas</a>
                <a href="view-detalhada.html" class="nav-btn green">üìã Detalhada</a>
                <button class="nav-btn purple" onclick="abrirPrintModal('print')">üñ®Ô∏è Imprimir</button>
                <button class="nav-btn blue" onclick="abrirPrintModal('pdf')">üìÑ Gerar PDF</button>
            </nav>
        </header>
        
        <main class="content">
            <div class="toggle">
                <button id="btnMacro" class="active" onclick="setView('macro')">üìä Vis√£o Executiva (Macro)</button>
                <button id="btnMicro" onclick="setView('micro')">üìã Vis√£o por Projeto (Micro)</button>
            </div>
            
            <div class="kpis" id="kpis"></div>
            
            <div class="phases-legend">
                <strong>Fases:</strong> 1. Inicia√ß√£o ¬∑ 2. Planejamento ¬∑ 3. Provisionamento ¬∑ 4. Implementa√ß√£o ¬∑ 5. Testes ¬∑ 6. Deploy ¬∑ 7. Estabiliza√ß√£o ¬∑ 8. Encerramento
            </div>
            
            <div class="filters">
                <div class="filter-group">
                    <label>üîç Buscar:</label>
                    <input type="text" id="search" placeholder="Nome do projeto..." oninput="render()">
                </div>
                <div class="filter-group">
                    <label>üìä Status:</label>
                    <select id="filterStatus" onchange="render()">
                        <option value="">Todos</option>
                        <option value="Conclu√≠do">Conclu√≠do</option>
                        <option value="Em andamento">Em andamento</option>
                        <option value="Aguardando">Aguardando</option>
                        <option value="N√£o Iniciado">N√£o Iniciado</option>
                        <option value="Atrasado">Atrasado</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>‚ö° Prioridade:</label>
                    <select id="filterPrior" onchange="render()">
                        <option value="">Todas</option>
                        <option value="Alta">Alta</option>
                        <option value="M√©dia">M√©dia</option>
                        <option value="Baixa">Baixa</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>üìç Local:</label>
                    <select id="filterLocal" onchange="render()"></select>
                </div>
                <div class="filter-group">
                    <label>üë§ Respons√°vel:</label>
                    <select id="filterResp" onchange="render()"></select>
                </div>
                <label class="checkbox-group">
                    <input type="checkbox" id="filterCritico" onchange="render()">
                    <span>üö® Apenas Cr√≠ticos</span>
                </label>
            </div>
            
            <div id="macroView" class="phases"></div>
            <div id="microView" class="projects" style="display:none;"></div>
            
            <div class="timestamp" id="ts"></div>
        </main>
    </div>
    
    <!-- Modal Projeto -->
    <div class="modal-bg" id="modal" onclick="fecharModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-head">
                <h2 id="modalTitle">Projeto</h2>
                <div class="modal-head-btns">
                    <button class="modal-print-btn" onclick="imprimirProjeto()">üñ®Ô∏è Imprimir</button>
                    <button class="modal-close" onclick="fecharModal()">√ó</button>
                </div>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>
    
    <!-- Modal Impress√£o/PDF -->
    <div class="modal-bg" id="printModal" onclick="fecharPrintModal(event)">
        <div class="modal print-modal" onclick="event.stopPropagation()">
            <div class="modal-head">
                <h2 id="printModalTitle">üñ®Ô∏è Imprimir</h2>
                <button class="modal-close" onclick="fecharPrintModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="print-options">
                    <label class="print-option selected" onclick="selecionarOpcao(this, 'atual')">
                        <input type="radio" name="printType" value="atual" checked>
                        <div class="print-option-text">
                            <div class="print-option-title">üìã Filtro Atual</div>
                            <div class="print-option-desc">Projetos vis√≠veis na tela com os filtros aplicados</div>
                        </div>
                    </label>
                    <label class="print-option" onclick="selecionarOpcao(this, 'todos')">
                        <input type="radio" name="printType" value="todos">
                        <div class="print-option-text">
                            <div class="print-option-title">üìÅ Todos os Projetos</div>
                            <div class="print-option-desc">Incluir todos os projetos independente dos filtros</div>
                        </div>
                    </label>
                    <label class="print-option" onclick="selecionarOpcao(this, 'criticos')">
                        <input type="radio" name="printType" value="criticos">
                        <div class="print-option-text">
                            <div class="print-option-title">üö® Apenas Cr√≠ticos</div>
                            <div class="print-option-desc">Somente projetos atrasados ou com prioridade alta</div>
                        </div>
                    </label>
                    <label class="print-option" onclick="selecionarOpcao(this, 'especificos')">
                        <input type="radio" name="printType" value="especificos">
                        <div class="print-option-text">
                            <div class="print-option-title">‚úÖ Projetos Espec√≠ficos</div>
                            <div class="print-option-desc">Selecionar manualmente quais projetos incluir</div>
                        </div>
                    </label>
                </div>
                <div class="print-projects-list" id="printProjectsList"></div>
                <div class="print-select-buttons" id="printSelectButtons" style="display:none;margin-top:10px;gap:10px;">
                    <button type="button" onclick="marcarTodos(true)" style="flex:1;padding:8px 12px;background:#22c55e;color:white;border:none;border-radius:6px;font-weight:600;cursor:pointer;">‚úÖ Marcar todos</button>
                    <button type="button" onclick="marcarTodos(false)" style="flex:1;padding:8px 12px;background:#ef4444;color:white;border:none;border-radius:6px;font-weight:600;cursor:pointer;">‚ùå Desmarcar todos</button>
                </div>
                <div class="print-buttons">
                    <button class="btn-cancel" onclick="fecharPrintModal()">Cancelar</button>
                    <button class="btn-execute" id="btnExecutePrint" onclick="executarPrint()">üñ®Ô∏è Imprimir</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Atividade -->
    <div class="modal-bg" id="activityModal" onclick="fecharActivityModal(event)">
        <div class="modal activity-modal" onclick="event.stopPropagation()">
            <div class="modal-head">
                <h2 id="activityModalTitle">Detalhes da Atividade</h2>
                <button class="modal-close" onclick="fecharActivityModal()">√ó</button>
            </div>
            <div class="modal-body" id="activityModalBody"></div>
        </div>
    </div>

<script>
const PROJETOS = [
    { nome: 'BARBECUE B2B', local: 'S√£o Paulo - SP', resp: 'ALEX', prioridade: 'Alta', dataInicio: '2025-06-01', dataPrevista: '2026-02-06' },
    { nome: 'BELEZA', local: 'S√£o Paulo - SP', resp: 'ANDERSON', prioridade: 'M√©dia', dataInicio: '2025-03-01', dataPrevista: '2025-11-30' },
    { nome: 'BETA', local: 'Rio de Janeiro - RJ', resp: 'ANDERSON', prioridade: 'Alta', dataInicio: '2024-12-15', dataPrevista: '2026-03-10' },
    { nome: 'BETA ESTEIO', local: 'Esteio - RS', resp: 'ANDERSON', prioridade: 'M√©dia', dataInicio: '2026-01-16', dataPrevista: '2026-08-17' },
    { nome: 'BP', local: 'S√£o Paulo - SP', resp: 'GIOVANNI', prioridade: 'M√©dia', dataInicio: '2026-03-01', dataPrevista: '2026-06-23' },
    { nome: 'BR', local: 'Jaboat√£o - PE', resp: 'F√ÅBIO', prioridade: 'Alta', dataInicio: '2026-01-29', dataPrevista: '2026-06-26' },
    { nome: 'CANDELABRIA', local: 'Candel√°ria - RS', resp: 'ALEX', prioridade: 'M√©dia', dataInicio: '2025-03-01', dataPrevista: '2025-12-09' },
    { nome: 'CDSK', local: 'S√£o Paulo - SP', resp: 'VINICIUS', prioridade: 'Alta', dataInicio: '2025-06-01', dataPrevista: '2026-02-10' },
    { nome: 'COUGAR', local: 'S√£o Paulo - SP', resp: 'LEANDRO', prioridade: 'Alta', dataInicio: '2024-12-01', dataPrevista: '2026-02-09' },
    { nome: 'CRISTAL MG RETROFIT', local: 'Belo Horizonte - MG', resp: 'GIOVANNI', prioridade: 'Alta', dataInicio: '2025-09-01', dataPrevista: '2026-06-30' },
    { nome: 'DIA', local: 'S√£o Paulo - SP', resp: 'ANDERSON', prioridade: 'Alta', dataInicio: '2026-01-01', dataPrevista: '2026-01-20' },
    { nome: 'DIAMANTE', local: 'Curitiba - PR', resp: 'F√ÅBIO', prioridade: 'M√©dia', dataInicio: '2026-02-15', dataPrevista: '2026-07-30' },
    { nome: 'ELETRO', local: 'S√£o Paulo - SP', resp: 'GIOVANNI', prioridade: 'M√©dia', dataInicio: '2026-02-01', dataPrevista: '2026-04-20' },
    { nome: 'ESPERAN√áA', local: 'Belo Horizonte - MG', resp: 'VINICIUS', prioridade: 'M√©dia', dataInicio: '2025-01-05', dataPrevista: '2026-01-19' },
    { nome: 'FLOWER', local: 'S√£o Paulo - SP', resp: 'ANDERSON', prioridade: 'Baixa', dataInicio: '2026-01-22', dataPrevista: '2026-09-30' },
    { nome: 'GAVI√ÉO', local: 'Fortaleza - CE', resp: 'F√ÅBIO', prioridade: 'Alta', dataInicio: '2025-10-01', dataPrevista: '2026-02-28' },
    { nome: 'MKT CHILE', local: 'Santiago - Chile', resp: 'ALEX', prioridade: 'M√©dia', dataInicio: '2026-06-01', dataPrevista: '2026-12-01' },
    { nome: 'MKT PERU', local: 'Lima - Peru', resp: 'ALEX', prioridade: 'M√©dia', dataInicio: '2026-06-01', dataPrevista: '2026-12-01' },
    { nome: 'MASTER', local: 'S√£o Paulo - SP', resp: 'LEANDRO', prioridade: 'Alta', dataInicio: '2026-03-01', dataPrevista: '2026-09-30' },
    { nome: 'NAVEPARK', local: 'Curitiba - PR', resp: 'ANDERSON', prioridade: 'M√©dia', dataInicio: '2024-12-16', dataPrevista: '2026-06-20' },
    { nome: 'OCTOPUS MS', local: 'Campo Grande - MS', resp: 'ALEX', prioridade: 'M√©dia', dataInicio: '2026-01-01', dataPrevista: '2026-06-15' },
    { nome: 'OCTOPUS SC', local: 'Florian√≥polis - SC', resp: 'ALEX', prioridade: 'M√©dia', dataInicio: '2025-06-01', dataPrevista: '2025-12-15' },
    { nome: 'OPTIMUS PRIME', local: 'S√£o Paulo - SP', resp: 'GIOVANNI', prioridade: 'Alta', dataInicio: '2025-10-18', dataPrevista: '2025-10-27' },
    { nome: 'PBL GUATEMALA', local: 'Guatemala City', resp: 'F√ÅBIO', prioridade: 'Alta', dataInicio: '2026-01-10', dataPrevista: '2026-05-15' },
    { nome: 'PROMO B2B CD GRU', local: 'Guarulhos - SP', resp: 'LEANDRO', prioridade: 'Alta', dataInicio: '2025-05-01', dataPrevista: '2026-02-04' },
    { nome: 'PTL SP', local: 'S√£o Paulo - SP', resp: 'VINICIUS', prioridade: 'M√©dia', dataInicio: '2025-04-01', dataPrevista: '2025-10-30' },
    { nome: 'REISADO', local: 'Recife - PE', resp: 'F√ÅBIO', prioridade: 'M√©dia', dataInicio: '2025-07-01', dataPrevista: '2025-12-20' },
    { nome: 'REVERSE', local: 'S√£o Paulo - SP', resp: 'ALEX', prioridade: 'Alta', dataInicio: '2025-08-01', dataPrevista: '2026-04-30' },
    { nome: 'SUPER DIVINOPOLIS', local: 'Divin√≥polis - MG', resp: 'GIOVANNI', prioridade: 'M√©dia', dataInicio: '2025-09-01', dataPrevista: '2026-03-30' },
    { nome: 'TITANIO', local: 'S√£o Paulo - SP', resp: 'ALEX', prioridade: 'Alta', dataInicio: '2025-09-01', dataPrevista: '2026-03-15' }
];

const FASES = ['1. Inicia√ß√£o','2. Planejamento & Documenta√ß√£o','3. Provisionamento de Recursos','4. Implementa√ß√£o','5. Testes & Homologa√ß√£o','6. Deploy em Produ√ß√£o','7. Estabiliza√ß√£o','8. Encerramento'];

const ATIVIDADES = [
    // BARBECUE B2B - Conclu√≠do 100%
    {proj:'BARBECUE B2B',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-06-01',dataFim:'2025-06-10',resp:'ALEX',descricao:'Kickoff realizado'},
    {proj:'BARBECUE B2B',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-06-15',dataFim:'2025-07-15',resp:'ALEX',descricao:'Documenta√ß√£o completa'},
    {proj:'BARBECUE B2B',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-07-20',dataFim:'2025-08-20',resp:'ALEX',descricao:'Recursos provisionados'},
    {proj:'BARBECUE B2B',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-08-25',dataFim:'2025-10-30',resp:'ALEX',descricao:'Implementa√ß√£o conclu√≠da'},
    {proj:'BARBECUE B2B',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-11-01',dataFim:'2025-12-15',resp:'ALEX',descricao:'Testes OK'},
    {proj:'BARBECUE B2B',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'Conclu√≠do',dataInicio:'2025-12-20',dataFim:'2026-01-20',resp:'ALEX',descricao:'Deploy realizado'},
    {proj:'BARBECUE B2B',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'Conclu√≠do',dataInicio:'2026-01-22',dataFim:'2026-02-01',resp:'ALEX',descricao:'Sistema est√°vel'},
    {proj:'BARBECUE B2B',nome:'Encerramento',fase:'8. Encerramento',status:'Conclu√≠do',dataInicio:'2026-02-02',dataFim:'2026-02-06',resp:'ALEX',descricao:'Acompanhamento Assistido e RAMP-UP'},
    // BELEZA - Conclu√≠do 100%
    {proj:'BELEZA',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-03-01',dataFim:'2025-03-10',resp:'ANDERSON',descricao:'Kickoff realizado'},
    {proj:'BELEZA',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-03-15',dataFim:'2025-04-15',resp:'ANDERSON',descricao:'Documenta√ß√£o completa'},
    {proj:'BELEZA',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-04-20',dataFim:'2025-05-20',resp:'ANDERSON',descricao:'Recursos OK'},
    {proj:'BELEZA',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-05-25',dataFim:'2025-08-01',resp:'ANDERSON',descricao:'Implementa√ß√£o conclu√≠da'},
    {proj:'BELEZA',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-08-05',dataFim:'2025-09-30',resp:'ANDERSON',descricao:'Testes OK'},
    {proj:'BELEZA',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-05',dataFim:'2025-10-30',resp:'ANDERSON',descricao:'Deploy realizado'},
    {proj:'BELEZA',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'Conclu√≠do',dataInicio:'2025-11-01',dataFim:'2025-11-20',resp:'ANDERSON',descricao:'Sistema est√°vel'},
    {proj:'BELEZA',nome:'Encerramento',fase:'8. Encerramento',status:'Conclu√≠do',dataInicio:'2025-11-22',dataFim:'2025-11-30',resp:'ANDERSON',descricao:'Projeto finalizado'},
    // BETA - Conclu√≠do 100%
    {proj:'BETA',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2024-12-15',dataFim:'2024-12-20',resp:'ANDERSON',descricao:'Kickoff realizado'},
    {proj:'BETA',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-01-05',dataFim:'2025-02-15',resp:'ANDERSON',descricao:'Documenta√ß√£o completa'},
    {proj:'BETA',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-02-20',dataFim:'2025-04-01',resp:'ANDERSON',descricao:'Recursos OK'},
    {proj:'BETA',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-04-05',dataFim:'2025-08-30',resp:'ANDERSON',descricao:'Implementa√ß√£o conclu√≠da'},
    {proj:'BETA',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-09-05',dataFim:'2025-11-30',resp:'ANDERSON',descricao:'Testes OK'},
    {proj:'BETA',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'Conclu√≠do',dataInicio:'2025-12-05',dataFim:'2026-01-31',resp:'ANDERSON',descricao:'Deploy realizado'},
    {proj:'BETA',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'Conclu√≠do',dataInicio:'2026-02-05',dataFim:'2026-03-01',resp:'ANDERSON',descricao:'Sistema est√°vel'},
    {proj:'BETA',nome:'Encerramento',fase:'8. Encerramento',status:'Conclu√≠do',dataInicio:'2026-03-05',dataFim:'2026-03-10',resp:'ANDERSON',descricao:'Go Live realizado'},
    // BETA ESTEIO - Planejamento 5%
    {proj:'BETA ESTEIO',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Em andamento',dataInicio:'2026-01-16',dataFim:'2026-01-25',resp:'ANDERSON',descricao:'Kickoff interno realizado em 16/01'},
    {proj:'BETA ESTEIO',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-02-01',dataFim:'2026-03-15',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'BETA ESTEIO',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'N√£o Iniciado',dataInicio:'2026-03-20',dataFim:'2026-04-30',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'BETA ESTEIO',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-05-05',dataFim:'2026-06-30',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'BETA ESTEIO',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-07-05',dataFim:'2026-07-30',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'BETA ESTEIO',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-08-01',dataFim:'2026-08-10',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'BETA ESTEIO',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-08-11',dataFim:'2026-08-15',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'BETA ESTEIO',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-08-16',dataFim:'2026-08-17',resp:'ANDERSON',descricao:'Aguardando'},
    // BP - Em andamento 15%
    {proj:'BP',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2026-03-01',dataFim:'2026-03-10',resp:'GIOVANNI',descricao:'Kickoff realizado'},
    {proj:'BP',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Em andamento',dataInicio:'2026-03-15',dataFim:'2026-04-15',resp:'GIOVANNI',descricao:'Aguardando defini√ß√£o de escopo'},
    {proj:'BP',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'N√£o Iniciado',dataInicio:'2026-04-20',dataFim:'2026-05-10',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'BP',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-05-15',dataFim:'2026-06-05',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'BP',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-08',dataFim:'2026-06-18',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'BP',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-19',dataFim:'2026-06-21',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'BP',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-22',dataFim:'2026-06-22',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'BP',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-06-23',dataFim:'2026-06-23',resp:'GIOVANNI',descricao:'Aguardando'},
    // BR - Planejamento 5%
    {proj:'BR',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Aguardando',dataInicio:'2026-01-29',dataFim:'2026-02-10',resp:'F√ÅBIO',descricao:'Aguardando Kickoff interno'},
    {proj:'BR',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-02-15',dataFim:'2026-03-15',resp:'F√ÅBIO',descricao:'Aguardando'},
    {proj:'BR',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'N√£o Iniciado',dataInicio:'2026-03-20',dataFim:'2026-04-15',resp:'F√ÅBIO',descricao:'Aguardando'},
    {proj:'BR',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-04-20',dataFim:'2026-05-30',resp:'F√ÅBIO',descricao:'Aguardando'},
    {proj:'BR',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-01',dataFim:'2026-06-15',resp:'F√ÅBIO',descricao:'Aguardando'},
    {proj:'BR',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-16',dataFim:'2026-06-22',resp:'F√ÅBIO',descricao:'Aguardando'},
    {proj:'BR',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-23',dataFim:'2026-06-25',resp:'F√ÅBIO',descricao:'Aguardando'},
    {proj:'BR',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-06-26',dataFim:'2026-06-26',resp:'F√ÅBIO',descricao:'Aguardando'},
    // CANDELABRIA - Conclu√≠do 100%
    {proj:'CANDELABRIA',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-03-01',dataFim:'2025-03-10',resp:'ALEX',descricao:'Kickoff realizado'},
    {proj:'CANDELABRIA',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-03-15',dataFim:'2025-04-30',resp:'ALEX',descricao:'Documenta√ß√£o completa'},
    {proj:'CANDELABRIA',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-05-05',dataFim:'2025-06-15',resp:'ALEX',descricao:'Recursos OK'},
    {proj:'CANDELABRIA',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-06-20',dataFim:'2025-08-30',resp:'ALEX',descricao:'Implementa√ß√£o conclu√≠da'},
    {proj:'CANDELABRIA',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-09-05',dataFim:'2025-10-15',resp:'ALEX',descricao:'Testes OK'},
    {proj:'CANDELABRIA',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-20',dataFim:'2025-11-15',resp:'ALEX',descricao:'Deploy realizado'},
    {proj:'CANDELABRIA',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'Conclu√≠do',dataInicio:'2025-11-20',dataFim:'2025-12-05',resp:'ALEX',descricao:'Sistema est√°vel'},
    {proj:'CANDELABRIA',nome:'Encerramento',fase:'8. Encerramento',status:'Conclu√≠do',dataInicio:'2025-12-06',dataFim:'2025-12-09',resp:'ALEX',descricao:'Go Live realizado em 09/12'},
    // CDSK - Em andamento 75%
    {proj:'CDSK',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-06-01',dataFim:'2025-06-10',resp:'VINICIUS',descricao:'Kickoff realizado'},
    {proj:'CDSK',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-06-15',dataFim:'2025-07-15',resp:'VINICIUS',descricao:'Documenta√ß√£o completa'},
    {proj:'CDSK',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-07-20',dataFim:'2025-08-20',resp:'VINICIUS',descricao:'Recursos OK'},
    {proj:'CDSK',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-08-25',dataFim:'2025-10-30',resp:'VINICIUS',descricao:'Implementa√ß√£o conclu√≠da'},
    {proj:'CDSK',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-11-01',dataFim:'2025-12-15',resp:'VINICIUS',descricao:'Testes OK'},
    {proj:'CDSK',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'Em andamento',dataInicio:'2025-12-20',dataFim:'2026-02-01',resp:'VINICIUS',descricao:'Go Live Fase 1 em andamento'},
    {proj:'CDSK',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-02-02',dataFim:'2026-02-08',resp:'VINICIUS',descricao:'Aguardando'},
    {proj:'CDSK',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-02-09',dataFim:'2026-02-10',resp:'VINICIUS',descricao:'Aguardando'},
    // COUGAR - Conclu√≠do 100%
    {proj:'COUGAR',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2024-12-01',dataFim:'2024-12-10',resp:'LEANDRO',descricao:'Kickoff realizado'},
    {proj:'COUGAR',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2024-12-15',dataFim:'2025-02-01',resp:'LEANDRO',descricao:'Documenta√ß√£o completa'},
    {proj:'COUGAR',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-02-05',dataFim:'2025-04-01',resp:'LEANDRO',descricao:'Recursos OK'},
    {proj:'COUGAR',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-04-05',dataFim:'2025-08-30',resp:'LEANDRO',descricao:'Implementa√ß√£o conclu√≠da'},
    {proj:'COUGAR',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-09-05',dataFim:'2025-11-30',resp:'LEANDRO',descricao:'Testes OK'},
    {proj:'COUGAR',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'Conclu√≠do',dataInicio:'2025-12-05',dataFim:'2026-01-20',resp:'LEANDRO',descricao:'Deploy realizado'},
    {proj:'COUGAR',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'Conclu√≠do',dataInicio:'2026-01-22',dataFim:'2026-02-05',resp:'LEANDRO',descricao:'Sistema est√°vel'},
    {proj:'COUGAR',nome:'Encerramento',fase:'8. Encerramento',status:'Conclu√≠do',dataInicio:'2026-02-06',dataFim:'2026-02-09',resp:'LEANDRO',descricao:'Go Live B2B realizado em 09/02'},
    // CRISTAL MG RETROFIT - Em andamento 15%
    {proj:'CRISTAL MG RETROFIT',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-09-01',dataFim:'2025-09-10',resp:'GIOVANNI',descricao:'Kickoff realizado'},
    {proj:'CRISTAL MG RETROFIT',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Em andamento',dataInicio:'2025-09-15',dataFim:'2026-02-28',resp:'GIOVANNI',descricao:'Cliente com revis√£o de escopo'},
    {proj:'CRISTAL MG RETROFIT',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'N√£o Iniciado',dataInicio:'2026-03-01',dataFim:'2026-04-01',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'CRISTAL MG RETROFIT',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-04-05',dataFim:'2026-05-15',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'CRISTAL MG RETROFIT',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-05-20',dataFim:'2026-06-10',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'CRISTAL MG RETROFIT',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-15',dataFim:'2026-06-25',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'CRISTAL MG RETROFIT',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-26',dataFim:'2026-06-28',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'CRISTAL MG RETROFIT',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-06-29',dataFim:'2026-06-30',resp:'GIOVANNI',descricao:'Aguardando'},
    // DIA - Atrasado 30%
    {proj:'DIA',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2026-01-01',dataFim:'2026-01-05',resp:'ANDERSON',descricao:'Kickoff realizado'},
    {proj:'DIA',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2026-01-06',dataFim:'2026-01-10',resp:'ANDERSON',descricao:'Documenta√ß√£o OK'},
    {proj:'DIA',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Em andamento',dataInicio:'2026-01-11',dataFim:'2026-01-18',resp:'ANDERSON',descricao:'ATEN√á√ÉO: Aguardando retorno cliente sobre VPN'},
    {proj:'DIA',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-01-19',dataFim:'2026-01-19',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'DIA',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-01-19',dataFim:'2026-01-19',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'DIA',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-01-20',dataFim:'2026-01-20',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'DIA',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-01-20',dataFim:'2026-01-20',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'DIA',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-01-20',dataFim:'2026-01-20',resp:'ANDERSON',descricao:'Aguardando'},
    // DIAMANTE - Planejamento 0%
    {proj:'DIAMANTE',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-02-15',dataFim:'2026-02-25',resp:'F√ÅBIO',descricao:'Novo projeto - fase inicial'},
    {proj:'DIAMANTE',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-03-01',dataFim:'2026-04-01',resp:'F√ÅBIO',descricao:'Aguardando'},
    {proj:'DIAMANTE',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'N√£o Iniciado',dataInicio:'2026-04-05',dataFim:'2026-05-01',resp:'F√ÅBIO',descricao:'Aguardando'},
    {proj:'DIAMANTE',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-05-05',dataFim:'2026-06-15',resp:'F√ÅBIO',descricao:'Aguardando'},
    {proj:'DIAMANTE',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-20',dataFim:'2026-07-10',resp:'F√ÅBIO',descricao:'Aguardando'},
    {proj:'DIAMANTE',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-07-15',dataFim:'2026-07-25',resp:'F√ÅBIO',descricao:'Aguardando'},
    {proj:'DIAMANTE',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-07-26',dataFim:'2026-07-28',resp:'F√ÅBIO',descricao:'Aguardando'},
    {proj:'DIAMANTE',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-07-29',dataFim:'2026-07-30',resp:'F√ÅBIO',descricao:'Aguardando'},
    // ELETRO - Em andamento 35%
    {proj:'ELETRO',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2026-02-01',dataFim:'2026-02-05',resp:'GIOVANNI',descricao:'Kickoff realizado'},
    {proj:'ELETRO',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2026-02-06',dataFim:'2026-02-20',resp:'GIOVANNI',descricao:'Documenta√ß√£o OK'},
    {proj:'ELETRO',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2026-02-21',dataFim:'2026-03-05',resp:'GIOVANNI',descricao:'Recursos OK'},
    {proj:'ELETRO',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Em andamento',dataInicio:'2026-03-06',dataFim:'2026-03-30',resp:'GIOVANNI',descricao:'Fase de implementa√ß√£o'},
    {proj:'ELETRO',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-04-01',dataFim:'2026-04-12',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'ELETRO',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-04-13',dataFim:'2026-04-17',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'ELETRO',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-04-18',dataFim:'2026-04-19',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'ELETRO',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-04-20',dataFim:'2026-04-20',resp:'GIOVANNI',descricao:'Aguardando'},
    // ESPERAN√áA - Conclu√≠do 100%
    {proj:'ESPERAN√áA',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-01-05',dataFim:'2025-01-15',resp:'VINICIUS',descricao:'Kickoff realizado'},
    {proj:'ESPERAN√áA',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-01-20',dataFim:'2025-03-01',resp:'VINICIUS',descricao:'Documenta√ß√£o completa'},
    {proj:'ESPERAN√áA',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-03-05',dataFim:'2025-04-15',resp:'VINICIUS',descricao:'Recursos OK'},
    {proj:'ESPERAN√áA',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-04-20',dataFim:'2025-08-01',resp:'VINICIUS',descricao:'Implementa√ß√£o conclu√≠da'},
    {proj:'ESPERAN√áA',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-08-05',dataFim:'2025-10-30',resp:'VINICIUS',descricao:'Testes OK'},
    {proj:'ESPERAN√áA',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'Conclu√≠do',dataInicio:'2025-11-05',dataFim:'2025-12-20',resp:'VINICIUS',descricao:'Deploy realizado'},
    {proj:'ESPERAN√áA',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'Conclu√≠do',dataInicio:'2025-12-22',dataFim:'2026-01-15',resp:'VINICIUS',descricao:'Sistema est√°vel'},
    {proj:'ESPERAN√áA',nome:'Encerramento',fase:'8. Encerramento',status:'Conclu√≠do',dataInicio:'2026-01-16',dataFim:'2026-01-19',resp:'VINICIUS',descricao:'Go Live realizado em 19/01/26'},
    // FLOWER - Em andamento 10%
    {proj:'FLOWER',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2026-01-22',dataFim:'2026-01-30',resp:'ANDERSON',descricao:'Kickoff realizado'},
    {proj:'FLOWER',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Em andamento',dataInicio:'2026-02-01',dataFim:'2026-04-01',resp:'ANDERSON',descricao:'Avalia√ß√£o conceitual em andamento'},
    {proj:'FLOWER',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'N√£o Iniciado',dataInicio:'2026-04-05',dataFim:'2026-05-15',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'FLOWER',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-05-20',dataFim:'2026-07-30',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'FLOWER',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-08-05',dataFim:'2026-09-01',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'FLOWER',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-09-05',dataFim:'2026-09-20',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'FLOWER',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-09-22',dataFim:'2026-09-28',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'FLOWER',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-09-29',dataFim:'2026-09-30',resp:'ANDERSON',descricao:'Aguardando'},
    // GAVI√ÉO - Conclu√≠do 100%
    {proj:'GAVI√ÉO',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-01',dataFim:'2025-10-10',resp:'F√ÅBIO',descricao:'Kickoff realizado'},
    {proj:'GAVI√ÉO',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-15',dataFim:'2025-11-01',resp:'F√ÅBIO',descricao:'Documenta√ß√£o completa'},
    {proj:'GAVI√ÉO',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-11-05',dataFim:'2025-11-20',resp:'F√ÅBIO',descricao:'Recursos OK'},
    {proj:'GAVI√ÉO',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-11-25',dataFim:'2025-12-20',resp:'F√ÅBIO',descricao:'Implementa√ß√£o conclu√≠da'},
    {proj:'GAVI√ÉO',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-12-22',dataFim:'2026-01-10',resp:'F√ÅBIO',descricao:'Testes OK'},
    {proj:'GAVI√ÉO',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'Conclu√≠do',dataInicio:'2026-01-12',dataFim:'2026-01-25',resp:'F√ÅBIO',descricao:'Deploy realizado'},
    {proj:'GAVI√ÉO',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'Conclu√≠do',dataInicio:'2026-01-27',dataFim:'2026-01-31',resp:'F√ÅBIO',descricao:'Sistema est√°vel'},
    {proj:'GAVI√ÉO',nome:'Encerramento',fase:'8. Encerramento',status:'Conclu√≠do',dataInicio:'2026-02-01',dataFim:'2026-02-01',resp:'F√ÅBIO',descricao:'Go Live realizado'},
    // MKT CHILE - Planejamento 0%
    {proj:'MKT CHILE',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-01',dataFim:'2026-06-15',resp:'ALEX',descricao:'Aguardando Kickoff interno'},
    {proj:'MKT CHILE',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-20',dataFim:'2026-07-30',resp:'ALEX',descricao:'Aguardando'},
    {proj:'MKT CHILE',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'N√£o Iniciado',dataInicio:'2026-08-05',dataFim:'2026-09-01',resp:'ALEX',descricao:'Aguardando'},
    {proj:'MKT CHILE',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-09-05',dataFim:'2026-10-30',resp:'ALEX',descricao:'Aguardando'},
    {proj:'MKT CHILE',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-11-02',dataFim:'2026-11-20',resp:'ALEX',descricao:'Aguardando'},
    {proj:'MKT CHILE',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-11-23',dataFim:'2026-11-28',resp:'ALEX',descricao:'Aguardando'},
    {proj:'MKT CHILE',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-11-29',dataFim:'2026-11-30',resp:'ALEX',descricao:'Aguardando'},
    {proj:'MKT CHILE',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-12-01',dataFim:'2026-12-01',resp:'ALEX',descricao:'Aguardando'},
    // MKT PERU - Planejamento 0%
    {proj:'MKT PERU',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-01',dataFim:'2026-06-15',resp:'ALEX',descricao:'Aguardando confirma√ß√£o de pedido'},
    {proj:'MKT PERU',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-20',dataFim:'2026-07-30',resp:'ALEX',descricao:'Aguardando'},
    {proj:'MKT PERU',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'N√£o Iniciado',dataInicio:'2026-08-05',dataFim:'2026-09-01',resp:'ALEX',descricao:'Aguardando'},
    {proj:'MKT PERU',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-09-05',dataFim:'2026-10-30',resp:'ALEX',descricao:'Aguardando'},
    {proj:'MKT PERU',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-11-02',dataFim:'2026-11-20',resp:'ALEX',descricao:'Aguardando'},
    {proj:'MKT PERU',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-11-23',dataFim:'2026-11-28',resp:'ALEX',descricao:'Aguardando'},
    {proj:'MKT PERU',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-11-29',dataFim:'2026-11-30',resp:'ALEX',descricao:'Aguardando'},
    {proj:'MKT PERU',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-12-01',dataFim:'2026-12-01',resp:'ALEX',descricao:'Aguardando'},
    // MASTER - Planejamento 0%
    {proj:'MASTER',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-03-01',dataFim:'2026-03-15',resp:'LEANDRO',descricao:'Aguardando defini√ß√£o de requisitos'},
    {proj:'MASTER',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-03-20',dataFim:'2026-05-01',resp:'LEANDRO',descricao:'Aguardando'},
    {proj:'MASTER',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'N√£o Iniciado',dataInicio:'2026-05-05',dataFim:'2026-06-01',resp:'LEANDRO',descricao:'Aguardando'},
    {proj:'MASTER',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-05',dataFim:'2026-08-01',resp:'LEANDRO',descricao:'Aguardando'},
    {proj:'MASTER',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-08-05',dataFim:'2026-09-01',resp:'LEANDRO',descricao:'Aguardando'},
    {proj:'MASTER',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-09-05',dataFim:'2026-09-20',resp:'LEANDRO',descricao:'Aguardando'},
    {proj:'MASTER',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-09-22',dataFim:'2026-09-28',resp:'LEANDRO',descricao:'Aguardando'},
    {proj:'MASTER',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-09-29',dataFim:'2026-09-30',resp:'LEANDRO',descricao:'Aguardando'},
    // NAVEPARK - Em andamento 25%
    {proj:'NAVEPARK',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2024-12-16',dataFim:'2024-12-20',resp:'ANDERSON',descricao:'Kickoff realizado'},
    {proj:'NAVEPARK',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-01-05',dataFim:'2025-02-28',resp:'ANDERSON',descricao:'Documenta√ß√£o completa'},
    {proj:'NAVEPARK',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Em andamento',dataInicio:'2025-03-05',dataFim:'2026-02-28',resp:'ANDERSON',descricao:'Aguardando pagamento do sinal'},
    {proj:'NAVEPARK',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-03-01',dataFim:'2026-04-30',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'NAVEPARK',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-05-05',dataFim:'2026-05-30',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'NAVEPARK',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-02',dataFim:'2026-06-15',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'NAVEPARK',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-16',dataFim:'2026-06-19',resp:'ANDERSON',descricao:'Aguardando'},
    {proj:'NAVEPARK',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-06-20',dataFim:'2026-06-20',resp:'ANDERSON',descricao:'Aguardando'},
    // OCTOPUS MS - Em andamento 40%
    {proj:'OCTOPUS MS',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2026-01-01',dataFim:'2026-01-10',resp:'ALEX',descricao:'Kickoff realizado'},
    {proj:'OCTOPUS MS',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2026-01-12',dataFim:'2026-01-30',resp:'ALEX',descricao:'Documenta√ß√£o OK'},
    {proj:'OCTOPUS MS',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2026-02-01',dataFim:'2026-02-20',resp:'ALEX',descricao:'Recursos OK'},
    {proj:'OCTOPUS MS',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Em andamento',dataInicio:'2026-02-22',dataFim:'2026-04-15',resp:'ALEX',descricao:'Go Live previsto para 15/06/26'},
    {proj:'OCTOPUS MS',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-04-20',dataFim:'2026-05-15',resp:'ALEX',descricao:'Aguardando'},
    {proj:'OCTOPUS MS',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-05-18',dataFim:'2026-06-05',resp:'ALEX',descricao:'Aguardando'},
    {proj:'OCTOPUS MS',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-06-08',dataFim:'2026-06-12',resp:'ALEX',descricao:'Aguardando'},
    {proj:'OCTOPUS MS',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-06-13',dataFim:'2026-06-15',resp:'ALEX',descricao:'Aguardando'},
    // OCTOPUS SC - Conclu√≠do 100%
    {proj:'OCTOPUS SC',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-06-01',dataFim:'2025-06-10',resp:'ALEX',descricao:'Kickoff realizado'},
    {proj:'OCTOPUS SC',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-06-15',dataFim:'2025-07-15',resp:'ALEX',descricao:'Documenta√ß√£o completa'},
    {proj:'OCTOPUS SC',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-07-20',dataFim:'2025-08-15',resp:'ALEX',descricao:'Recursos OK'},
    {proj:'OCTOPUS SC',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-08-20',dataFim:'2025-10-01',resp:'ALEX',descricao:'Implementa√ß√£o conclu√≠da'},
    {proj:'OCTOPUS SC',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-05',dataFim:'2025-11-01',resp:'ALEX',descricao:'Testes OK'},
    {proj:'OCTOPUS SC',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'Conclu√≠do',dataInicio:'2025-11-05',dataFim:'2025-11-30',resp:'ALEX',descricao:'Deploy realizado'},
    {proj:'OCTOPUS SC',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'Conclu√≠do',dataInicio:'2025-12-02',dataFim:'2025-12-12',resp:'ALEX',descricao:'Sistema est√°vel'},
    {proj:'OCTOPUS SC',nome:'Encerramento',fase:'8. Encerramento',status:'Conclu√≠do',dataInicio:'2025-12-13',dataFim:'2025-12-15',resp:'ALEX',descricao:'Projeto finalizado'},
    // OPTIMUS PRIME - Conclu√≠do 100%
    {proj:'OPTIMUS PRIME',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-18',dataFim:'2025-10-18',resp:'GIOVANNI',descricao:'Kickoff realizado'},
    {proj:'OPTIMUS PRIME',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-19',dataFim:'2025-10-20',resp:'GIOVANNI',descricao:'Documenta√ß√£o OK'},
    {proj:'OPTIMUS PRIME',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-10-21',dataFim:'2025-10-22',resp:'GIOVANNI',descricao:'Recursos OK'},
    {proj:'OPTIMUS PRIME',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-23',dataFim:'2025-10-24',resp:'GIOVANNI',descricao:'Implementa√ß√£o conclu√≠da'},
    {proj:'OPTIMUS PRIME',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-25',dataFim:'2025-10-25',resp:'GIOVANNI',descricao:'Testes OK'},
    {proj:'OPTIMUS PRIME',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-26',dataFim:'2025-10-26',resp:'GIOVANNI',descricao:'Deploy realizado'},
    {proj:'OPTIMUS PRIME',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-27',dataFim:'2025-10-27',resp:'GIOVANNI',descricao:'Sistema est√°vel'},
    {proj:'OPTIMUS PRIME',nome:'Encerramento',fase:'8. Encerramento',status:'Conclu√≠do',dataInicio:'2025-10-27',dataFim:'2025-10-27',resp:'GIOVANNI',descricao:'Acompanhamento Assistido OK'},
    // PBL GUATEMALA - Em andamento 45%
    {proj:'PBL GUATEMALA',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2026-01-10',dataFim:'2026-01-15',resp:'F√ÅBIO',descricao:'Kickoff realizado'},
    {proj:'PBL GUATEMALA',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2026-01-16',dataFim:'2026-01-30',resp:'F√ÅBIO',descricao:'Documenta√ß√£o OK'},
    {proj:'PBL GUATEMALA',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2026-02-01',dataFim:'2026-02-15',resp:'F√ÅBIO',descricao:'Recursos OK'},
    {proj:'PBL GUATEMALA',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Em andamento',dataInicio:'2026-02-17',dataFim:'2026-04-01',resp:'F√ÅBIO',descricao:'Projeto internacional em andamento'},
    {proj:'PBL GUATEMALA',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-04-05',dataFim:'2026-04-30',resp:'F√ÅBIO',descricao:'Aguardando'},
    {proj:'PBL GUATEMALA',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-05-02',dataFim:'2026-05-10',resp:'F√ÅBIO',descricao:'Aguardando'},
    {proj:'PBL GUATEMALA',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-05-11',dataFim:'2026-05-14',resp:'F√ÅBIO',descricao:'Aguardando'},
    {proj:'PBL GUATEMALA',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-05-15',dataFim:'2026-05-15',resp:'F√ÅBIO',descricao:'Aguardando'},
    // PROMO B2B CD GRU - Conclu√≠do 100%
    {proj:'PROMO B2B CD GRU',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-05-01',dataFim:'2025-05-10',resp:'LEANDRO',descricao:'Kickoff realizado'},
    {proj:'PROMO B2B CD GRU',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-05-15',dataFim:'2025-06-30',resp:'LEANDRO',descricao:'Documenta√ß√£o completa'},
    {proj:'PROMO B2B CD GRU',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-07-05',dataFim:'2025-08-15',resp:'LEANDRO',descricao:'Recursos OK'},
    {proj:'PROMO B2B CD GRU',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-08-20',dataFim:'2025-11-01',resp:'LEANDRO',descricao:'Implementa√ß√£o conclu√≠da'},
    {proj:'PROMO B2B CD GRU',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-11-05',dataFim:'2025-12-15',resp:'LEANDRO',descricao:'Testes OK'},
    {proj:'PROMO B2B CD GRU',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'Conclu√≠do',dataInicio:'2025-12-18',dataFim:'2026-01-20',resp:'LEANDRO',descricao:'Deploy realizado'},
    {proj:'PROMO B2B CD GRU',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'Conclu√≠do',dataInicio:'2026-01-22',dataFim:'2026-02-01',resp:'LEANDRO',descricao:'Sistema est√°vel'},
    {proj:'PROMO B2B CD GRU',nome:'Encerramento',fase:'8. Encerramento',status:'Conclu√≠do',dataInicio:'2026-02-02',dataFim:'2026-02-04',resp:'LEANDRO',descricao:'Go Live IA realizado em 04/02/26'},
    // PTL SP - Conclu√≠do 100%
    {proj:'PTL SP',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-04-01',dataFim:'2025-04-10',resp:'VINICIUS',descricao:'Kickoff realizado'},
    {proj:'PTL SP',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-04-15',dataFim:'2025-05-15',resp:'VINICIUS',descricao:'Documenta√ß√£o completa'},
    {proj:'PTL SP',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-05-20',dataFim:'2025-06-15',resp:'VINICIUS',descricao:'Recursos OK'},
    {proj:'PTL SP',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-06-20',dataFim:'2025-08-15',resp:'VINICIUS',descricao:'Implementa√ß√£o conclu√≠da'},
    {proj:'PTL SP',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-08-20',dataFim:'2025-09-30',resp:'VINICIUS',descricao:'Testes OK'},
    {proj:'PTL SP',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-02',dataFim:'2025-10-20',resp:'VINICIUS',descricao:'Deploy realizado'},
    {proj:'PTL SP',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-22',dataFim:'2025-10-28',resp:'VINICIUS',descricao:'Sistema est√°vel'},
    {proj:'PTL SP',nome:'Encerramento',fase:'8. Encerramento',status:'Conclu√≠do',dataInicio:'2025-10-29',dataFim:'2025-10-30',resp:'VINICIUS',descricao:'Projeto finalizado'},
    // REISADO - Conclu√≠do 100%
    {proj:'REISADO',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-07-01',dataFim:'2025-07-10',resp:'F√ÅBIO',descricao:'Kickoff realizado'},
    {proj:'REISADO',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-07-15',dataFim:'2025-08-15',resp:'F√ÅBIO',descricao:'Documenta√ß√£o completa'},
    {proj:'REISADO',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-08-20',dataFim:'2025-09-15',resp:'F√ÅBIO',descricao:'Recursos OK'},
    {proj:'REISADO',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-09-20',dataFim:'2025-10-30',resp:'F√ÅBIO',descricao:'Implementa√ß√£o conclu√≠da'},
    {proj:'REISADO',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-11-02',dataFim:'2025-11-30',resp:'F√ÅBIO',descricao:'Testes OK'},
    {proj:'REISADO',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'Conclu√≠do',dataInicio:'2025-12-02',dataFim:'2025-12-12',resp:'F√ÅBIO',descricao:'Deploy realizado'},
    {proj:'REISADO',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'Conclu√≠do',dataInicio:'2025-12-14',dataFim:'2025-12-18',resp:'F√ÅBIO',descricao:'Sistema est√°vel'},
    {proj:'REISADO',nome:'Encerramento',fase:'8. Encerramento',status:'Conclu√≠do',dataInicio:'2025-12-19',dataFim:'2025-12-20',resp:'F√ÅBIO',descricao:'Projeto finalizado'},
    // REVERSE - Em andamento 55%
    {proj:'REVERSE',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-08-01',dataFim:'2025-08-10',resp:'ALEX',descricao:'Kickoff realizado'},
    {proj:'REVERSE',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-08-15',dataFim:'2025-09-15',resp:'ALEX',descricao:'Documenta√ß√£o completa'},
    {proj:'REVERSE',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-09-20',dataFim:'2025-10-20',resp:'ALEX',descricao:'Recursos OK'},
    {proj:'REVERSE',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-25',dataFim:'2025-12-15',resp:'ALEX',descricao:'Implementa√ß√£o conclu√≠da'},
    {proj:'REVERSE',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'Em andamento',dataInicio:'2025-12-20',dataFim:'2026-02-28',resp:'ALEX',descricao:'Fase de testes'},
    {proj:'REVERSE',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-03-02',dataFim:'2026-03-15',resp:'ALEX',descricao:'Aguardando'},
    {proj:'REVERSE',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-03-16',dataFim:'2026-04-15',resp:'ALEX',descricao:'Aguardando'},
    {proj:'REVERSE',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-04-20',dataFim:'2026-04-30',resp:'ALEX',descricao:'Aguardando'},
    // SUPER DIVINOPOLIS - Em andamento 50%
    {proj:'SUPER DIVINOPOLIS',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-09-01',dataFim:'2025-09-10',resp:'GIOVANNI',descricao:'Kickoff realizado'},
    {proj:'SUPER DIVINOPOLIS',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-09-15',dataFim:'2025-10-15',resp:'GIOVANNI',descricao:'Documenta√ß√£o OK'},
    {proj:'SUPER DIVINOPOLIS',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-10-20',dataFim:'2025-11-15',resp:'GIOVANNI',descricao:'Recursos OK'},
    {proj:'SUPER DIVINOPOLIS',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Em andamento',dataInicio:'2025-11-20',dataFim:'2026-02-01',resp:'GIOVANNI',descricao:'Em fase de implementa√ß√£o'},
    {proj:'SUPER DIVINOPOLIS',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-02-05',dataFim:'2026-02-25',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'SUPER DIVINOPOLIS',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-02-26',dataFim:'2026-03-15',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'SUPER DIVINOPOLIS',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-03-18',dataFim:'2026-03-28',resp:'GIOVANNI',descricao:'Aguardando'},
    {proj:'SUPER DIVINOPOLIS',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-03-29',dataFim:'2026-03-30',resp:'GIOVANNI',descricao:'Aguardando'},
    // TITANIO - Em andamento 80%
    {proj:'TITANIO',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-09-01',dataFim:'2025-09-10',resp:'ALEX',descricao:'Kickoff realizado'},
    {proj:'TITANIO',nome:'Documenta√ß√£o',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-09-15',dataFim:'2025-10-01',resp:'ALEX',descricao:'Documenta√ß√£o completa'},
    {proj:'TITANIO',nome:'Provisionamento',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-10-05',dataFim:'2025-10-25',resp:'ALEX',descricao:'Recursos OK'},
    {proj:'TITANIO',nome:'Implementa√ß√£o',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-28',dataFim:'2025-12-01',resp:'ALEX',descricao:'Implementa√ß√£o conclu√≠da'},
    {proj:'TITANIO',nome:'Testes',fase:'5. Testes & Homologa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-12-05',dataFim:'2026-01-10',resp:'ALEX',descricao:'Testes OK'},
    {proj:'TITANIO',nome:'Deploy',fase:'6. Deploy em Produ√ß√£o',status:'Conclu√≠do',dataInicio:'2026-01-12',dataFim:'2026-01-25',resp:'ALEX',descricao:'Deploy realizado'},
    {proj:'TITANIO',nome:'Estabiliza√ß√£o',fase:'7. Estabiliza√ß√£o',status:'Em andamento',dataInicio:'2026-01-27',dataFim:'2026-02-15',resp:'ALEX',descricao:'Fase de estabiliza√ß√£o'},
    {proj:'TITANIO',nome:'Encerramento',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-03-10',dataFim:'2026-03-15',resp:'ALEX',descricao:'Aguardando'}
];

let view='macro', projetoFiltro='', projetoAtual='', printMode='print';
const hoje=new Date();hoje.setHours(0,0,0,0);

function parseDate(s){if(!s)return null;const[y,m,d]=s.split('-').map(Number);return new Date(y,m-1,d)}
function formatDate(s){if(!s)return'-';const[y,m,d]=s.split('-');return`${d}/${m}/${y}`}
function diasAtraso(dp){const p=parseDate(dp);if(!p)return 0;const d=Math.floor((hoje-p)/(1000*60*60*24));return d>0?d:0}
function getAtividades(p){return ATIVIDADES.filter(a=>a.proj===p)}
function calcProgresso(p){const a=getAtividades(p);if(!a.length)return 0;return Math.round(a.filter(x=>x.status==='Conclu√≠do').length/a.length*100)}
function calcStatus(p){const pr=PROJETOS.find(x=>x.nome===p),pg=calcProgresso(p);if(pg===100)return'Conclu√≠do';if(pr&&diasAtraso(pr.dataPrevista)>0&&pg<100)return'Atrasado';if(pg===0){const a=getAtividades(p);if(a.some(x=>x.status==='Aguardando'))return'Aguardando';return'N√£o Iniciado'}const a=getAtividades(p);if(a.some(x=>x.status==='Em andamento'))return'Em andamento';if(a.some(x=>x.status==='Aguardando'))return'Aguardando';return'Em andamento'}
function calcFaseAtual(p){const a=getAtividades(p);if(!a.length)return FASES[0];if(a.every(x=>x.status==='Conclu√≠do'))return FASES[7];for(const f of FASES){const af=a.filter(x=>x.fase===f);if(af.some(x=>x.status==='Em andamento'))return f}for(const f of FASES){const af=a.filter(x=>x.fase===f);if(af.some(x=>x.status==='Aguardando'))return f}for(const f of FASES){const af=a.filter(x=>x.fase===f);if(af.length&&!af.every(x=>x.status==='Conclu√≠do'))return f}return FASES[0]}
function calcProximaFase(p){const f=calcFaseAtual(p),i=FASES.indexOf(f);return i<FASES.length-1?FASES[i+1]:null}
function calcProximaEntrega(p){const a=getAtividades(p).filter(x=>x.status!=='Conclu√≠do').sort((a,b)=>parseDate(a.dataInicio)-parseDate(b.dataInicio));return a.length?a[0]:null}
function isCritico(p){const pr=PROJETOS.find(x=>x.nome===p),s=calcStatus(p);return s==='Atrasado'||pr?.prioridade==='Alta'||s==='Aguardando'}
function getCor(pct){return pct>=100?'verde':pct>=50?'amarelo':'vermelho'}
function getStatusClass(s){return s.toLowerCase().replace(/ /g,'-').replace('√£','a')}

function getContextoFase(f,ps){if(ps.some(p=>calcStatus(p.nome)==='Atrasado'))return{tipo:'danger',texto:'üö® Projeto(s) atrasado(s)'};let todasFut=true,algPassou=false;ps.forEach(p=>{const af=getAtividades(p.nome).filter(a=>a.fase===f);af.forEach(a=>{const d=parseDate(a.dataInicio);if(d&&d<=hoje){todasFut=false;if(a.status==='N√£o Iniciado')algPassou=true}})});if(todasFut)return{tipo:'gray',texto:'‚è≥ Aguardando in√≠cio'};if(algPassou)return{tipo:'warning',texto:'‚ö†Ô∏è Aten√ß√£o ao cronograma'};return null}
function faseTemAlerta(f,ps){return ps.some(p=>isCritico(p.nome)||calcStatus(p.nome)==='Atrasado')}

function getProjetosFiltrados(){const s=document.getElementById('search').value.toLowerCase(),st=document.getElementById('filterStatus').value,pr=document.getElementById('filterPrior').value,lo=document.getElementById('filterLocal').value,re=document.getElementById('filterResp').value,cr=document.getElementById('filterCritico').checked;return PROJETOS.filter(p=>{const ps=calcStatus(p.nome);return(!s||p.nome.toLowerCase().includes(s))&&(!st||ps===st)&&(!pr||p.prioridade===pr)&&(!lo||p.local===lo)&&(!re||p.resp===re)&&(!cr||isCritico(p.nome))&&(!projetoFiltro||p.nome===projetoFiltro)})}
function populateFilters(){const l=[...new Set(PROJETOS.map(p=>p.local))].sort(),r=[...new Set(PROJETOS.map(p=>p.resp))].sort();document.getElementById('filterLocal').innerHTML='<option value="">Todos</option>'+l.map(x=>`<option value="${x}">${x}</option>`).join('');document.getElementById('filterResp').innerHTML='<option value="">Todos</option>'+r.map(x=>`<option value="${x}">${x}</option>`).join('')}

function renderKPIs(){const ps=getProjetosFiltrados(),t=ps.length,c=ps.filter(p=>calcStatus(p.nome)==='Conclu√≠do').length,e=ps.filter(p=>calcStatus(p.nome)==='Em andamento').length,a=ps.filter(p=>calcStatus(p.nome)==='Atrasado').length,cr=ps.filter(p=>isCritico(p.nome)).length;document.getElementById('kpis').innerHTML=`<div class="kpi azul"><div class="num">${t}</div><div class="lbl">Total</div></div><div class="kpi verde"><div class="num">${c}</div><div class="lbl">Conclu√≠dos</div></div><div class="kpi amarelo"><div class="num">${e}</div><div class="lbl">Em Andamento</div></div><div class="kpi vermelho"><div class="num">${a}</div><div class="lbl">Atrasados</div></div><div class="kpi vermelho"><div class="num">${cr}</div><div class="lbl">Cr√≠ticos</div></div>`}

function setView(v){view=v;document.getElementById('btnMacro').classList.toggle('active',v==='macro');document.getElementById('btnMicro').classList.toggle('active',v==='micro');document.getElementById('macroView').style.display=v==='macro'?'grid':'none';document.getElementById('microView').style.display=v==='micro'?'grid':'none';render()}
function render(){renderKPIs();if(view==='macro')renderMacro();else renderMicro();document.getElementById('ts').textContent='Atualizado em: '+new Date().toLocaleString('pt-BR')}

function renderMacro(){const c=document.getElementById('macroView'),ps=getProjetosFiltrados(),pf={};FASES.forEach(f=>pf[f]=[]);ps.forEach(p=>{const f=calcFaseAtual(p.nome);pf[f].push(p)});let h='';FASES.forEach(f=>{const pjs=pf[f];if(!pjs.length)return;let ta=0,co=0;pjs.forEach(p=>{const af=getAtividades(p.nome).filter(a=>a.fase===f);ta+=af.length;co+=af.filter(a=>a.status==='Conclu√≠do').length});const pct=ta?Math.round(co/ta*100):0,cor=getCor(pct),al=faseTemAlerta(f,pjs),ctx=getContextoFase(f,pjs);h+=`<div class="phase-card ${cor}"><div class="phase-header"><div class="phase-title-group"><span class="phase-title">${f}</span><span class="phase-count">${pjs.length} projeto${pjs.length>1?'s':''}</span>${al?'<span class="phase-alert">‚ö†Ô∏è</span>':''}</div><span class="phase-percent ${cor}">${pct}%</span></div><div class="phase-bar"><div class="phase-bar-fill ${cor}" style="width:${pct}%"></div></div>${ctx?`<div class="phase-context ${ctx.tipo}">${ctx.texto}</div>`:''}<div class="phase-info">${co}/${ta} atividades conclu√≠das</div><div class="phase-projects">${pjs.map(p=>`<span class="badge ${isCritico(p.nome)?'critico':''}" onclick="filtrarProjeto('${p.nome}')">${p.nome}</span>`).join('')}</div></div>`});c.innerHTML=h||'<div class="empty">Nenhum projeto encontrado</div>'}

function renderMicro(){const c=document.getElementById('microView'),ps=getProjetosFiltrados();if(!ps.length){c.innerHTML='<div class="empty">Nenhum projeto encontrado</div>';return}c.innerHTML=ps.map(p=>{const pg=calcProgresso(p.nome),st=calcStatus(p.nome),fa=calcFaseAtual(p.nome),pf=calcProximaFase(p.nome),cor=getCor(pg),at=diasAtraso(p.dataPrevista);return`<div class="project-card ${cor}" onclick="abrirModal('${p.nome}')"><div class="project-header"><span class="project-name">${p.nome}</span><span class="priority ${p.prioridade.toLowerCase()}">${p.prioridade}</span></div><div class="project-meta"><span>üìç ${p.local}</span><span>üë§ ${p.resp}</span></div><div class="project-phase">üìò Fase: ${fa}</div>${pf?`<div class="project-next-phase"><strong>Pr√≥xima:</strong> ${pf}</div>`:''}<div class="project-dates"><span>üìÖ In√≠cio: ${formatDate(p.dataInicio)}</span><span>üéØ T√©rmino previsto: ${formatDate(p.dataPrevista)}</span>${at>0&&pg<100?`<span class="atrasado">‚ö†Ô∏è ${at} dias atraso</span>`:''}</div><div class="progress"><div class="progress-header"><span>Progresso</span><span style="color:${cor==='verde'?'#22c55e':cor==='amarelo'?'#f59e0b':'#ef4444'}">${pg}%</span></div><div class="progress-bar"><div class="progress-fill ${cor}" style="width:${pg}%"></div></div></div><div class="project-footer"><span class="status-badge ${getStatusClass(st)}">${st}</span>${at>0&&pg<100?'<span class="delay-badge">üö® Cr√≠tico</span>':''}</div></div>`}).join('')}

function abrirModal(proj){
    projetoAtual=proj;
    const p=PROJETOS.find(x=>x.nome===proj),a=getAtividades(proj),pg=calcProgresso(proj),fa=calcFaseAtual(proj),pf=calcProximaFase(proj),pe=calcProximaEntrega(proj),st=calcStatus(proj),at=diasAtraso(p?.dataPrevista),dn=a.filter(x=>x.status==='Conclu√≠do').length,dg=a.filter(x=>x.status==='Em andamento').length,wa=a.filter(x=>x.status==='Aguardando').length,ns=a.filter(x=>x.status==='N√£o Iniciado').length;
    document.getElementById('modalTitle').textContent=`üìã ${proj}`;
    let mh='';if(pe)mh=`<div class="modal-entrega"><div class="modal-entrega-title">üéØ Pr√≥xima Entrega</div><div class="modal-entrega-content">${pe.nome} ‚Äì ${formatDate(pe.dataInicio)}</div></div>`;
    document.getElementById('modalBody').innerHTML=`
    <div class="modal-info">
        <div class="modal-info-item"><span class="label">Local</span><span class="value">${p?.local||'-'}</span></div>
        <div class="modal-info-item"><span class="label">Respons√°vel</span><span class="value">${p?.resp||'-'}</span></div>
        <div class="modal-info-item"><span class="label">Prioridade</span><span class="value">${p?.prioridade||'-'}</span></div>
        <div class="modal-info-item"><span class="label">In√≠cio</span><span class="value">${formatDate(p?.dataInicio)}</span></div>
        <div class="modal-info-item"><span class="label">T√©rmino Previsto</span><span class="value">${formatDate(p?.dataPrevista)}</span></div>
        ${at>0&&pg<100?`<div class="modal-info-item"><span class="label">Atraso</span><span class="value danger">‚ö†Ô∏è ${at} dias</span></div>`:''}
    </div>
    ${mh}
    <div class="summary">
        <div class="summary-item"><div class="num" style="color:#22c55e">${dn}</div><div class="lbl">Conclu√≠das</div></div>
        <div class="summary-item"><div class="num" style="color:#3b82f6">${dg}</div><div class="lbl">Em andamento</div></div>
        <div class="summary-item"><div class="num" style="color:#f59e0b">${wa}</div><div class="lbl">Aguardando</div></div>
        <div class="summary-item"><div class="num" style="color:#6b7280">${ns}</div><div class="lbl">N√£o iniciadas</div></div>
    </div>
    <p style="margin-bottom:12px;color:#64748b;font-size:0.9em"><strong>Fase atual:</strong> ${fa} | <strong>Progresso:</strong> ${pg}%${pf?` | <strong>Pr√≥xima:</strong> ${pf}`:''}</p>
    <p style="margin-bottom:8px;color:#94a3b8;font-size:0.8em">üí° Clique em uma atividade para ver detalhes</p>
    <div class="activity-list">${a.map(x=>`<div class="activity" onclick="abrirAtividade('${proj}','${x.nome}')"><div class="activity-info"><div class="activity-name">${x.nome}</div><div class="activity-fase">${x.fase}</div><div class="activity-dates">üìÖ ${formatDate(x.dataInicio)} ‚Üí ${formatDate(x.dataFim)}</div></div><div class="activity-resp">üë§ ${x.resp}</div><span class="status-badge ${getStatusClass(x.status)}">${x.status}</span></div>`).join('')}</div>`;
    document.getElementById('modal').classList.add('show');
}

function fecharModal(e){if(!e||e.target.id==='modal')document.getElementById('modal').classList.remove('show')}
function filtrarProjeto(n){projetoFiltro=n;document.getElementById('search').value=n;setView('micro')}

// Modal Atividade
function abrirAtividade(proj,nomeAtiv){
    const a=ATIVIDADES.find(x=>x.proj===proj&&x.nome===nomeAtiv);
    if(!a)return;
    document.getElementById('activityModalTitle').textContent=`üìå ${a.nome}`;
    document.getElementById('activityModalBody').innerHTML=`
        <div class="activity-detail">
            <div class="activity-detail-row"><span class="activity-detail-label">Projeto</span><span class="activity-detail-value">${a.proj}</span></div>
            <div class="activity-detail-row"><span class="activity-detail-label">Fase</span><span class="activity-detail-value">${a.fase}</span></div>
            <div class="activity-detail-row"><span class="activity-detail-label">Respons√°vel</span><span class="activity-detail-value">${a.resp}</span></div>
            <div class="activity-detail-row"><span class="activity-detail-label">Data In√≠cio</span><span class="activity-detail-value">${formatDate(a.dataInicio)}</span></div>
            <div class="activity-detail-row"><span class="activity-detail-label">Data T√©rmino</span><span class="activity-detail-value">${formatDate(a.dataFim)}</span></div>
            <div class="activity-detail-row"><span class="activity-detail-label">Status</span><span class="activity-detail-value"><span class="status-badge ${getStatusClass(a.status)}">${a.status}</span></span></div>
            <div class="activity-detail-row"><span class="activity-detail-label">Descri√ß√£o</span><span class="activity-detail-value">${a.descricao||'-'}</span></div>
        </div>
        <div class="activity-history">
            <h4>üìù Hist√≥rico de Tratativas</h4>
            <div class="activity-history-empty">Nenhuma tratativa registrada ainda.<br><small>Em vers√µes futuras, aqui aparecer√£o todas as atualiza√ß√µes e coment√°rios desta atividade.</small></div>
        </div>
    `;
    document.getElementById('activityModal').classList.add('show');
}
function fecharActivityModal(e){if(!e||e.target.id==='activityModal')document.getElementById('activityModal').classList.remove('show')}

// Imprimir Projeto Individual
function imprimirProjeto(){
    const p=PROJETOS.find(x=>x.nome===projetoAtual);
    if(!p)return;
    const a=getAtividades(projetoAtual),pg=calcProgresso(projetoAtual),fa=calcFaseAtual(projetoAtual),st=calcStatus(projetoAtual),at=diasAtraso(p.dataPrevista);
    const w=window.open('','_blank');
    w.document.write(`<!DOCTYPE html><html><head><title>${projetoAtual}</title><style>body{font-family:Segoe UI,sans-serif;padding:30px;max-width:800px;margin:0 auto}h1{color:#667eea;border-bottom:3px solid #667eea;padding-bottom:10px}table{width:100%;border-collapse:collapse;margin:15px 0}th,td{border:1px solid #e2e8f0;padding:10px;text-align:left}th{background:#f8fafc}.info{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin:15px 0}.info-item{padding:10px;background:#f8fafc;border-radius:6px}.info-label{color:#64748b;font-size:0.85em}.info-value{font-weight:600;color:#1e293b}.status{display:inline-block;padding:4px 12px;border-radius:4px;font-size:0.85em;font-weight:600}.concluido{background:#dcfce7;color:#166534}.em-andamento{background:#dbeafe;color:#1e40af}.aguardando{background:#fef3c7;color:#92400e}.nao-iniciado{background:#f3f4f6;color:#4b5563}@media print{body{padding:15px}}</style></head><body>
    <h1>üìã ${projetoAtual}</h1>
    <div class="info">
        <div class="info-item"><div class="info-label">Local</div><div class="info-value">${p.local}</div></div>
        <div class="info-item"><div class="info-label">Respons√°vel</div><div class="info-value">${p.resp}</div></div>
        <div class="info-item"><div class="info-label">Prioridade</div><div class="info-value">${p.prioridade}</div></div>
        <div class="info-item"><div class="info-label">Fase Atual</div><div class="info-value">${fa}</div></div>
        <div class="info-item"><div class="info-label">In√≠cio</div><div class="info-value">${formatDate(p.dataInicio)}</div></div>
        <div class="info-item"><div class="info-label">T√©rmino Previsto</div><div class="info-value">${formatDate(p.dataPrevista)}</div></div>
        <div class="info-item"><div class="info-label">Progresso</div><div class="info-value">${pg}%</div></div>
        <div class="info-item"><div class="info-label">Status</div><div class="info-value"><span class="status ${getStatusClass(st)}">${st}</span></div></div>
        ${at>0&&pg<100?`<div class="info-item"><div class="info-label">Atraso</div><div class="info-value" style="color:#dc2626">‚ö†Ô∏è ${at} dias</div></div>`:''}
    </div>
    <h2>Atividades</h2>
    <table><thead><tr><th>Atividade</th><th>Fase</th><th>Respons√°vel</th><th>In√≠cio</th><th>T√©rmino</th><th>Status</th></tr></thead><tbody>
    ${a.map(x=>`<tr><td>${x.nome}</td><td>${x.fase}</td><td>${x.resp}</td><td>${formatDate(x.dataInicio)}</td><td>${formatDate(x.dataFim)}</td><td><span class="status ${getStatusClass(x.status)}">${x.status}</span></td></tr>`).join('')}
    </tbody></table>
    <p style="color:#94a3b8;text-align:center;margin-top:20px;font-size:0.85em">Gerado em ${new Date().toLocaleString('pt-BR')}</p>
    </body></html>`);
    w.document.close();
    setTimeout(()=>w.print(),300);
}

// Modal Impress√£o/PDF
function abrirPrintModal(mode){
    printMode=mode;
    document.getElementById('printModalTitle').textContent=mode==='pdf'?'üìÑ Gerar PDF':'üñ®Ô∏è Imprimir';
    document.getElementById('btnExecutePrint').textContent=mode==='pdf'?'üìÑ Gerar PDF':'üñ®Ô∏è Imprimir';
    document.getElementById('printProjectsList').innerHTML=PROJETOS.map(p=>`<label class="print-project-item"><input type="checkbox" value="${p.nome}" checked> ${p.nome}</label>`).join('');
    document.getElementById('printModal').classList.add('show');
}
function fecharPrintModal(e){if(!e||e.target.id==='printModal')document.getElementById('printModal').classList.remove('show')}

function selecionarOpcao(el,tipo){
    document.querySelectorAll('.print-option').forEach(o=>o.classList.remove('selected'));
    el.classList.add('selected');
    el.querySelector('input').checked=true;
    document.getElementById('printProjectsList').classList.toggle('show',tipo==='especificos');
    document.getElementById('printSelectButtons').style.display=tipo==='especificos'?'flex':'none';
}

function executarPrint(){
    const tipo=document.querySelector('input[name="printType"]:checked').value;
    let projetos=[];
    if(tipo==='atual'){projetos=getProjetosFiltrados()}
    else if(tipo==='todos'){projetos=PROJETOS}
    else if(tipo==='criticos'){projetos=PROJETOS.filter(p=>isCritico(p.nome))}
    else if(tipo==='especificos'){const checks=document.querySelectorAll('#printProjectsList input:checked');projetos=PROJETOS.filter(p=>[...checks].some(c=>c.value===p.nome))}
    
    if(!projetos.length){alert('Nenhum projeto selecionado!');return}
    fecharPrintModal();
    
    if(printMode==='pdf'){gerarPDF(projetos)}
    else{imprimirLista(projetos)}
}

function marcarTodos(marcar){
    document.querySelectorAll('#printProjectsList input[type="checkbox"]').forEach(cb=>cb.checked=marcar);
}

// Corrigir filtro ao digitar
document.addEventListener('DOMContentLoaded',function(){
    document.getElementById('search').addEventListener('input',function(){
        if(this.value.trim()===''){projetoFiltro=''}
        render();
    });
});

function imprimirLista(projetos){
    const w=window.open('','_blank');
    w.document.write(`<!DOCTYPE html><html><head><title>Projetos Infraestrutura</title><style>body{font-family:Segoe UI,sans-serif;padding:30px;max-width:1000px;margin:0 auto}h1{color:#667eea;text-align:center;border-bottom:3px solid #667eea;padding-bottom:15px}.kpis{display:grid;grid-template-columns:repeat(5,1fr);gap:10px;margin:20px 0}.kpi{text-align:center;padding:15px;background:#f8fafc;border-radius:8px;border-top:4px solid #e2e8f0}.kpi.verde{border-top-color:#22c55e}.kpi.amarelo{border-top-color:#f59e0b}.kpi.vermelho{border-top-color:#ef4444}.kpi.azul{border-top-color:#3b82f6}.kpi-num{font-size:1.8em;font-weight:700}.kpi-lbl{font-size:0.85em;color:#64748b}.project{border:1px solid #e2e8f0;border-radius:8px;padding:15px;margin:15px 0;page-break-inside:avoid}.project-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.project-name{font-size:1.1em;font-weight:700}.priority{padding:3px 8px;border-radius:4px;font-size:0.75em;font-weight:600}.alta{background:#fee2e2;color:#dc2626}.media{background:#fef3c7;color:#d97706}.baixa{background:#dcfce7;color:#16a34a}.project-info{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;font-size:0.9em;color:#64748b}.progress-bar{height:8px;background:#e2e8f0;border-radius:4px;margin:10px 0;overflow:hidden}.progress-fill{height:100%;border-radius:4px}.verde{background:#22c55e}.amarelo{background:#f59e0b}.vermelho{background:#ef4444}@media print{body{padding:15px}.kpis{grid-template-columns:repeat(5,1fr)}}</style></head><body>
    <h1>üìä Dashboard de Infraestrutura</h1>
    <div class="kpis">
        <div class="kpi azul"><div class="kpi-num">${projetos.length}</div><div class="kpi-lbl">Total</div></div>
        <div class="kpi verde"><div class="kpi-num">${projetos.filter(p=>calcStatus(p.nome)==='Conclu√≠do').length}</div><div class="kpi-lbl">Conclu√≠dos</div></div>
        <div class="kpi amarelo"><div class="kpi-num">${projetos.filter(p=>calcStatus(p.nome)==='Em andamento').length}</div><div class="kpi-lbl">Em Andamento</div></div>
        <div class="kpi vermelho"><div class="kpi-num">${projetos.filter(p=>calcStatus(p.nome)==='Atrasado').length}</div><div class="kpi-lbl">Atrasados</div></div>
        <div class="kpi vermelho"><div class="kpi-num">${projetos.filter(p=>isCritico(p.nome)).length}</div><div class="kpi-lbl">Cr√≠ticos</div></div>
    </div>
    ${projetos.map(p=>{const pg=calcProgresso(p.nome),st=calcStatus(p.nome),fa=calcFaseAtual(p.nome),at=diasAtraso(p.dataPrevista),cor=getCor(pg);return`
    <div class="project">
        <div class="project-header"><span class="project-name">${p.nome}</span><span class="priority ${p.prioridade.toLowerCase()}">${p.prioridade}</span></div>
        <div class="project-info"><span>üìç ${p.local}</span><span>üë§ ${p.resp}</span><span>üìò ${fa}</span><span>üìÖ In√≠cio: ${formatDate(p.dataInicio)}</span><span>üéØ T√©rmino: ${formatDate(p.dataPrevista)}</span><span>üìä Status: ${st}${at>0&&pg<100?` (${at}d atraso)`:''}</span></div>
        <div class="progress-bar"><div class="progress-fill ${cor}" style="width:${pg}%"></div></div>
        <div style="text-align:right;font-weight:600">${pg}%</div>
    </div>`}).join('')}
    <p style="color:#94a3b8;text-align:center;margin-top:30px;font-size:0.85em">Gerado em ${new Date().toLocaleString('pt-BR')}</p>
    </body></html>`);
    w.document.close();
    setTimeout(()=>w.print(),300);
}

function gerarPDF(projetos){
    const content=document.createElement('div');
    content.innerHTML=`<div style="font-family:Segoe UI,sans-serif;padding:20px;max-width:900px">
    <h1 style="color:#667eea;text-align:center;border-bottom:3px solid #667eea;padding-bottom:15px">üìä Dashboard de Infraestrutura</h1>
    <div style="display:grid;grid-template-columns:repeat(5,1fr);gap:10px;margin:20px 0">
        <div style="text-align:center;padding:15px;background:#f8fafc;border-radius:8px;border-top:4px solid #3b82f6"><div style="font-size:1.8em;font-weight:700">${projetos.length}</div><div style="font-size:0.85em;color:#64748b">Total</div></div>
        <div style="text-align:center;padding:15px;background:#f8fafc;border-radius:8px;border-top:4px solid #22c55e"><div style="font-size:1.8em;font-weight:700">${projetos.filter(p=>calcStatus(p.nome)==='Conclu√≠do').length}</div><div style="font-size:0.85em;color:#64748b">Conclu√≠dos</div></div>
        <div style="text-align:center;padding:15px;background:#f8fafc;border-radius:8px;border-top:4px solid #f59e0b"><div style="font-size:1.8em;font-weight:700">${projetos.filter(p=>calcStatus(p.nome)==='Em andamento').length}</div><div style="font-size:0.85em;color:#64748b">Em Andamento</div></div>
        <div style="text-align:center;padding:15px;background:#f8fafc;border-radius:8px;border-top:4px solid #ef4444"><div style="font-size:1.8em;font-weight:700">${projetos.filter(p=>calcStatus(p.nome)==='Atrasado').length}</div><div style="font-size:0.85em;color:#64748b">Atrasados</div></div>
        <div style="text-align:center;padding:15px;background:#f8fafc;border-radius:8px;border-top:4px solid #ef4444"><div style="font-size:1.8em;font-weight:700">${projetos.filter(p=>isCritico(p.nome)).length}</div><div style="font-size:0.85em;color:#64748b">Cr√≠ticos</div></div>
    </div>
    ${projetos.map(p=>{const pg=calcProgresso(p.nome),st=calcStatus(p.nome),fa=calcFaseAtual(p.nome),at=diasAtraso(p.dataPrevista),cor=pg>=100?'#22c55e':pg>=50?'#f59e0b':'#ef4444';return`
    <div style="border:1px solid #e2e8f0;border-radius:8px;padding:15px;margin:15px 0">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px"><span style="font-size:1.1em;font-weight:700">${p.nome}</span><span style="padding:3px 8px;border-radius:4px;font-size:0.75em;font-weight:600;background:${p.prioridade==='Alta'?'#fee2e2':p.prioridade==='M√©dia'?'#fef3c7':'#dcfce7'};color:${p.prioridade==='Alta'?'#dc2626':p.prioridade==='M√©dia'?'#d97706':'#16a34a'}">${p.prioridade}</span></div>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;font-size:0.9em;color:#64748b"><span>üìç ${p.local}</span><span>üë§ ${p.resp}</span><span>üìò ${fa}</span><span>üìÖ In√≠cio: ${formatDate(p.dataInicio)}</span><span>üéØ T√©rmino: ${formatDate(p.dataPrevista)}</span><span>üìä ${st}${at>0&&pg<100?` (${at}d atraso)`:''}</span></div>
        <div style="height:8px;background:#e2e8f0;border-radius:4px;margin:10px 0;overflow:hidden"><div style="height:100%;width:${pg}%;background:${cor};border-radius:4px"></div></div>
        <div style="text-align:right;font-weight:600">${pg}%</div>
    </div>`}).join('')}
    <p style="color:#94a3b8;text-align:center;margin-top:30px;font-size:0.85em">Gerado em ${new Date().toLocaleString('pt-BR')}</p>
    </div>`;
    
    html2pdf().set({margin:10,filename:'projetos-infraestrutura.pdf',image:{type:'jpeg',quality:0.98},html2canvas:{scale:2},jsPDF:{unit:'mm',format:'a4',orientation:'portrait'}}).from(content).save();
}

document.addEventListener('keydown',e=>{if(e.key==='Escape'){fecharModal();fecharPrintModal();fecharActivityModal()}});
window.addEventListener('DOMContentLoaded',()=>{localStorage.removeItem('infraDashboard');populateFilters();render()});
</script>
</body>
</html>
