<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Infraestrutura v8.0</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        
        .container { max-width: 1400px; margin: 0 auto; background: white; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); overflow: hidden; }
        
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px 25px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; }
        .header-left h1 { font-size: 1.4em; margin-bottom: 5px; }
        .header-left p { opacity: 0.9; font-size: 0.85em; }
        .version-tag { background: rgba(255,255,255,0.2); padding: 3px 10px; border-radius: 12px; font-size: 0.75em; margin-left: 10px; }
        
        .nav-buttons { display: flex; gap: 8px; flex-wrap: wrap; }
        .nav-btn { padding: 9px 16px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.85em; transition: all 0.2s; text-decoration: none; display: inline-flex; align-items: center; gap: 5px; color: white; }
        .nav-btn.green { background: #22c55e; }
        .nav-btn.green:hover { background: #16a34a; }
        .nav-btn.purple { background: #8b5cf6; }
        .nav-btn.purple:hover { background: #7c3aed; }
        .nav-btn.orange { background: #f59e0b; }
        .nav-btn.orange:hover { background: #d97706; }
        
        .content { padding: 20px 25px; }
        
        .dica { background: #eff6ff; border-left: 4px solid #3b82f6; padding: 12px 15px; margin-bottom: 18px; border-radius: 0 8px 8px 0; font-size: 0.85em; color: #1e40af; }
        .dica strong { color: #1d4ed8; }
        
        /* TOP ROW: KPIs + Prioridade + PMO */
        .top-section { margin-bottom: 20px; }
        .kpis-row { display: grid; grid-template-columns: repeat(5, 1fr) 160px 160px; gap: 12px; align-items: stretch; }
        @media (max-width: 1100px) { .kpis-row { grid-template-columns: repeat(5, 1fr); } .side-cards-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px; } }
        @media (max-width: 600px) { .kpis-row { grid-template-columns: repeat(2, 1fr); } .side-cards-row { grid-template-columns: 1fr; } }
        
        .kpi { text-align: center; padding: 15px 10px; border-radius: 10px; cursor: pointer; transition: all 0.2s; color: white; }
        .kpi:hover { transform: translateY(-3px); box-shadow: 0 6px 20px rgba(0,0,0,0.2); }
        .kpi.azul { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
        .kpi.verde { background: linear-gradient(135deg, #22c55e, #16a34a); }
        .kpi.amarelo { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .kpi.roxo { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
        .kpi.vermelho { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .kpi .num { font-size: 2em; font-weight: 700; }
        .kpi .lbl { font-size: 0.78em; opacity: 0.95; margin-top: 2px; }
        
        .side-card { background: #f8fafc; border-radius: 10px; padding: 12px 15px; border: 1px solid #e2e8f0; }
        .side-card h4 { font-size: 0.8em; color: #64748b; margin-bottom: 8px; display: flex; align-items: center; gap: 5px; }
        .side-items { display: flex; flex-direction: column; gap: 5px; }
        .side-item { display: flex; justify-content: space-between; align-items: center; padding: 6px 10px; border-radius: 6px; font-size: 0.85em; cursor: pointer; transition: all 0.2s; font-weight: 500; }
        .side-item:hover { transform: translateX(3px); }
        .side-item.alta { background: #fef2f2; color: #dc2626; }
        .side-item.media { background: #fffbeb; color: #b45309; }
        .side-item.baixa { background: #f0fdf4; color: #16a34a; }
        .side-item.pmo { background: #f1f5f9; color: #475569; }
        .side-item.pmo:hover { background: #e2e8f0; }
        .side-item .count { font-weight: 700; font-size: 1.1em; }
        
        /* ALERTAS */
        .alerts-section { margin-bottom: 20px; }
        .alert-header { padding: 12px 18px; border-radius: 10px 10px 0 0; color: white; font-weight: 600; font-size: 0.95em; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; }
        .alert-header.douglas { background: linear-gradient(135deg, #1e293b, #334155); }
        .alert-header.daiana { background: linear-gradient(135deg, #ea580c, #c2410c); }
        .alert-header small { font-weight: 400; opacity: 0.85; font-size: 0.85em; }
        
        .alert-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 12px; padding: 15px; background: #f8fafc; border-radius: 0 0 10px 10px; border: 1px solid #e2e8f0; border-top: none; }
        
        .alert-card { background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .alert-card-head { padding: 10px 12px; color: white; font-weight: 600; font-size: 0.85em; display: flex; justify-content: space-between; align-items: center; }
        .alert-card-head.vermelho { background: #ef4444; }
        .alert-card-head.amarelo { background: #f59e0b; }
        .alert-card-head.cinza { background: #64748b; }
        .alert-card-head.roxo { background: #8b5cf6; }
        .alert-card-head .badge { background: rgba(255,255,255,0.25); padding: 2px 8px; border-radius: 10px; font-size: 0.95em; }
        
        .alert-card-body { padding: 10px; max-height: 150px; overflow-y: auto; }
        .alert-proj { padding: 6px 10px; margin-bottom: 4px; border-radius: 6px; font-size: 0.85em; cursor: pointer; transition: all 0.2s; display: flex; justify-content: space-between; align-items: center; font-weight: 500; }
        .alert-proj:hover { transform: translateX(3px); }
        .alert-proj.vermelho { background: #fef2f2; color: #dc2626; }
        .alert-proj.amarelo { background: #fffbeb; color: #92400e; }
        .alert-proj.cinza { background: #f1f5f9; color: #64748b; }
        .alert-proj.roxo { background: #f5f3ff; color: #6d28d9; }
        .alert-proj .dias { font-size: 0.8em; opacity: 0.8; font-weight: 400; }
        .alert-empty { color: #94a3b8; font-size: 0.85em; padding: 15px; text-align: center; }
        
        /* TOGGLE E FILTROS */
        .toggle { display: flex; justify-content: center; margin-bottom: 18px; }
        .toggle button { padding: 11px 28px; border: 2px solid #667eea; background: white; color: #667eea; font-weight: 600; cursor: pointer; transition: all 0.2s; font-size: 0.95em; }
        .toggle button:first-child { border-radius: 25px 0 0 25px; }
        .toggle button:last-child { border-radius: 0 25px 25px 0; border-left: none; }
        .toggle button.active { background: #667eea; color: white; }
        
        .filters { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin-bottom: 18px; padding: 15px; background: #f8fafc; border-radius: 10px; align-items: end; }
        .filter-group label { display: block; font-size: 0.78em; color: #64748b; margin-bottom: 4px; font-weight: 500; }
        .filter-group input, .filter-group select { width: 100%; padding: 8px 10px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 0.9em; }
        .btn-limpar { padding: 8px 14px; background: #ef4444; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.85em; font-weight: 600; }
        .btn-limpar:hover { background: #dc2626; }
        
        /* CARDS DE PROJETOS */
        .projects { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 15px; }
        .project-card { background: white; border: 1px solid #e2e8f0; border-radius: 10px; padding: 15px; cursor: pointer; transition: all 0.2s; border-left: 4px solid #e2e8f0; }
        .project-card:hover { box-shadow: 0 5px 20px rgba(0,0,0,0.1); transform: translateY(-2px); }
        .project-card.verde { border-left-color: #22c55e; }
        .project-card.amarelo { border-left-color: #f59e0b; }
        .project-card.vermelho { border-left-color: #ef4444; }
        
        .project-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px; }
        .project-name { font-weight: 700; color: #1e293b; font-size: 1.05em; }
        .priority { padding: 3px 8px; border-radius: 4px; font-size: 0.7em; font-weight: 700; text-transform: uppercase; }
        .priority.alta { background: #fee2e2; color: #dc2626; }
        .priority.media { background: #fef3c7; color: #d97706; }
        .priority.baixa { background: #dcfce7; color: #16a34a; }
        
        .project-meta { display: flex; flex-wrap: wrap; gap: 12px; font-size: 0.82em; color: #64748b; margin-bottom: 8px; }
        .project-phase { background: #eff6ff; color: #1d4ed8; padding: 5px 10px; border-radius: 6px; font-size: 0.8em; margin-bottom: 8px; display: inline-block; font-weight: 500; }
        
        .progress { margin-bottom: 10px; }
        .progress-header { display: flex; justify-content: space-between; font-size: 0.85em; margin-bottom: 4px; color: #64748b; }
        .progress-header strong { color: #1e293b; }
        .progress-bar { height: 6px; background: #e2e8f0; border-radius: 3px; overflow: hidden; }
        .progress-fill { height: 100%; border-radius: 3px; }
        .progress-fill.verde { background: #22c55e; }
        .progress-fill.amarelo { background: #f59e0b; }
        .progress-fill.vermelho { background: #ef4444; }
        
        .project-footer { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 8px; }
        .status-badge { display: inline-block; padding: 4px 10px; border-radius: 5px; font-size: 0.75em; font-weight: 600; }
        .status-badge.concluido { background: #dcfce7; color: #166534; }
        .status-badge.em-andamento { background: #dbeafe; color: #1e40af; }
        .status-badge.planejamento { background: #f3e8ff; color: #7c3aed; }
        .status-badge.atrasado { background: #fee2e2; color: #991b1b; }
        
        .go-live-info { font-size: 0.8em; color: #64748b; }
        .go-live-info.atrasado { color: #dc2626; font-weight: 600; }
        .go-live-info.proximo { color: #d97706; font-weight: 600; }
        
        .empty { text-align: center; padding: 40px; color: #64748b; }
        
        /* MODAL */
        .modal-bg { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center; padding: 20px; }
        .modal-bg.show { display: flex; }
        .modal { background: white; border-radius: 12px; max-width: 700px; width: 100%; max-height: 85vh; overflow: hidden; }
        .modal-head { background: #667eea; color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; }
        .modal-head h2 { font-size: 1.1em; }
        .modal-close { background: rgba(255,255,255,0.2); border: none; color: white; width: 32px; height: 32px; border-radius: 50%; cursor: pointer; font-size: 1.3em; }
        .modal-close:hover { background: rgba(255,255,255,0.3); }
        .modal-body { padding: 20px; max-height: calc(85vh - 60px); overflow-y: auto; }
        
        .modal-info { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 12px; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #e2e8f0; }
        .modal-info-item .label { color: #64748b; display: block; font-size: 0.8em; margin-bottom: 2px; }
        .modal-info-item .value { color: #1e293b; font-weight: 600; font-size: 0.95em; }
        .modal-info-item .value.danger { color: #dc2626; }
        
        .modal-obs { background: #f8fafc; padding: 12px 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #667eea; }
        .modal-obs strong { color: #64748b; font-size: 0.85em; display: block; margin-bottom: 5px; }
        .modal-obs p { color: #1e293b; font-size: 0.95em; }
        
        .modal-dates { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 0.9em; color: #64748b; }
        .modal-dates strong { color: #1e293b; }
        
        .footer { text-align: center; padding: 15px; background: #f8fafc; border-top: 1px solid #e2e8f0; font-size: 0.8em; color: #64748b; }
        
        @media print { body { background: white; padding: 0; } .container { box-shadow: none; } .nav-buttons, .toggle, .filters, .dica { display: none !important; } }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-left">
                <h1>üìä Alertas & Projetos</h1>
                <p>Gest√£o de Projetos | Invent Corp | <span id="dataAtual"></span></p>
            </div>
            <div class="nav-buttons">
                <a href="index.html" class="nav-btn blue">üè† Vis√£o Executiva</a>
                <a href="view-detalhada.html" class="nav-btn purple">üìã Detalhada</a>
                <a href="admin.html" class="nav-btn green">‚öôÔ∏è Admin</a>
            </div>
        </header>
        
        <main class="content">
            <div class="dica">üí° <strong>Alertas e Projetos:</strong> Clique nos n√∫meros, cards de Prioridade/PMO ou nomes de projetos para filtrar. Alertas separados para GO LIVE (Douglas) e INFRA (Daiana).</div>
            
            <!-- KPIs + Prioridade + PMO -->
            <div class="top-section">
                <div class="kpis-row">
                    <div class="kpi azul" onclick="filtrarStatus('')" title="Ver todos">
                        <div class="num" id="kpiTotal">0</div>
                        <div class="lbl">Total</div>
                    </div>
                    <div class="kpi verde" onclick="filtrarStatus('Conclu√≠do')" title="Filtrar conclu√≠dos">
                        <div class="num" id="kpiConcluidos">0</div>
                        <div class="lbl">Conclu√≠dos</div>
                    </div>
                    <div class="kpi amarelo" onclick="filtrarStatus('Em andamento')" title="Filtrar em andamento">
                        <div class="num" id="kpiAndamento">0</div>
                        <div class="lbl">Em Andamento</div>
                    </div>
                    <div class="kpi roxo" onclick="filtrarStatus('Planejamento')" title="Filtrar planejamento">
                        <div class="num" id="kpiPlanejamento">0</div>
                        <div class="lbl">Planejamento</div>
                    </div>
                    <div class="kpi vermelho" onclick="filtrarStatus('Atrasado')" title="Filtrar atrasados">
                        <div class="num" id="kpiAtrasados">0</div>
                        <div class="lbl">Atrasados</div>
                    </div>
                    <div class="side-card">
                        <h4>‚ö° Prioridade</h4>
                        <div class="side-items" id="prioridadeItems"></div>
                    </div>
                    <div class="side-card">
                        <h4>üë§ PMO</h4>
                        <div class="side-items" id="pmoItems"></div>
                    </div>
                </div>
            </div>
            
            <!-- Alertas GO LIVE -->
            <div class="alerts-section">
                <div class="alert-header douglas">
                    <span>üéØ ALERTAS GO LIVE - VIS√ÉO GERAL (Para o Gestor Douglas)</span>
                    <small>Baseado na DATA do Go Live</small>
                </div>
                <div class="alert-cards" id="alertasGoLive"></div>
            </div>
            
            <!-- Alertas INFRA -->
            <div class="alerts-section">
                <div class="alert-header daiana">
                    <span>üîß ALERTAS INFRAESTRUTURA - MINHAS ATIVIDADES (Para Daiana)</span>
                    <small>Baseado no STATUS do trabalho</small>
                </div>
                <div class="alert-cards" id="alertasInfra"></div>
            </div>
            
            <!-- Toggle -->
            <div class="toggle">
                <button class="active" id="btnCards" onclick="setView('cards')">üìã Cards de Projetos</button>
                <button id="btnLista" onclick="setView('lista')">üìä Lista Resumida</button>
            </div>
            
            <!-- Filtros -->
            <div class="filters">
                <div class="filter-group">
                    <label>üîç Buscar</label>
                    <input type="text" id="filtroNome" placeholder="Nome..." oninput="renderProjetos()">
                </div>
                <div class="filter-group">
                    <label>üìä Status</label>
                    <select id="filtroStatus" onchange="renderProjetos()">
                        <option value="">Todos</option>
                        <option value="Conclu√≠do">Conclu√≠do</option>
                        <option value="Em andamento">Em andamento</option>
                        <option value="Planejamento">Planejamento</option>
                        <option value="Atrasado">Atrasado</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>‚ö° Prioridade</label>
                    <select id="filtroPrioridade" onchange="renderProjetos()">
                        <option value="">Todas</option>
                        <option value="Alta">Alta</option>
                        <option value="M√©dia">M√©dia</option>
                        <option value="Baixa">Baixa</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>üë§ PMO</label>
                    <select id="filtroPMO" onchange="renderProjetos()"></select>
                </div>
                <div class="filter-group">
                    <label>&nbsp;</label>
                    <button class="btn-limpar" onclick="limparFiltros()">üóëÔ∏è Limpar</button>
                </div>
            </div>
            
            <!-- Projetos -->
            <div class="projects" id="projetosGrid"></div>
        </main>
        
        <footer class="footer">Dashboard v8.0 | Invent Corp | <span id="timestamp"></span></footer>
    </div>
    
    <!-- Modal -->
    <div class="modal-bg" id="modal" onclick="fecharModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-head">
                <h2 id="modalTitle">Projeto</h2>
                <button class="modal-close" onclick="fecharModal()">√ó</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

<script>
const PROJETOS = [
    { id: 'P001', nome: 'BARBECUE B2B', status: 'Conclu√≠do', local: 'S√£o Paulo - SP', prioridade: 'Alta', dataInicio: '2025-06-01', dataPrevista: '2026-02-06', pmo: 'ALEX', goLive: '2026-02-06', obs: 'Acompanhamento Assistido e RAMP-UP', fase: '8. Encerramento', progresso: 100 },
    { id: 'P002', nome: 'BELEZA', status: 'Conclu√≠do', local: 'S√£o Paulo - SP', prioridade: 'M√©dia', dataInicio: '2025-03-01', dataPrevista: '2025-11-30', pmo: 'ANDERSON', goLive: '2025-11-30', obs: 'Projeto finalizado com sucesso', fase: '8. Encerramento', progresso: 100 },
    { id: 'P003', nome: 'BETA', status: 'Conclu√≠do', local: 'Rio de Janeiro - RJ', prioridade: 'Alta', dataInicio: '2024-12-15', dataPrevista: '2026-03-10', pmo: 'ANDERSON', goLive: '2026-03-10', obs: 'Go Live realizado', fase: '8. Encerramento', progresso: 100 },
    { id: 'P004', nome: 'BETA ESTEIO', status: 'Planejamento', local: 'Esteio - RS', prioridade: 'M√©dia', dataInicio: '2026-01-16', dataPrevista: '2026-08-17', pmo: 'ANDERSON', goLive: '2026-08-17', obs: 'Kickoff interno realizado em 16/01', fase: '1. Inicia√ß√£o', progresso: 5 },
    { id: 'P005', nome: 'BP', status: 'Em andamento', local: 'S√£o Paulo - SP', prioridade: 'M√©dia', dataInicio: '2026-03-01', dataPrevista: '2026-06-23', pmo: 'GIOVANNI', goLive: '2026-06-23', obs: 'Aguardando defini√ß√£o de escopo', fase: '2. Planejamento', progresso: 15 },
    { id: 'P006', nome: 'BR', status: 'Planejamento', local: 'Jaboat√£o - PE', prioridade: 'Alta', dataInicio: '2026-01-29', dataPrevista: '2026-06-26', pmo: 'F√ÅBIO', goLive: '', obs: 'Aguardando Kickoff interno', fase: '1. Inicia√ß√£o', progresso: 5 },
    { id: 'P007', nome: 'CANDELABRIA', status: 'Conclu√≠do', local: 'Candel√°ria - RS', prioridade: 'M√©dia', dataInicio: '2025-03-01', dataPrevista: '2025-12-09', pmo: 'ALEX', goLive: '2025-12-09', obs: 'Go Live realizado em 09/12', fase: '8. Encerramento', progresso: 100 },
    { id: 'P008', nome: 'CDSK', status: 'Em andamento', local: 'S√£o Paulo - SP', prioridade: 'Alta', dataInicio: '2025-06-01', dataPrevista: '2026-02-10', pmo: 'VINICIUS', goLive: '2026-02-10', obs: 'Go Live Fase 1 em andamento', fase: '6. Deploy', progresso: 75 },
    { id: 'P009', nome: 'COUGAR', status: 'Conclu√≠do', local: 'S√£o Paulo - SP', prioridade: 'Alta', dataInicio: '2024-12-01', dataPrevista: '2026-02-09', pmo: 'LEANDRO', goLive: '2026-02-09', obs: 'Go Live B2B realizado em 09/02', fase: '8. Encerramento', progresso: 100 },
    { id: 'P010', nome: 'CRISTAL MG RETROFIT', status: 'Em andamento', local: 'Belo Horizonte - MG', prioridade: 'Alta', dataInicio: '2025-09-01', dataPrevista: '2026-06-30', pmo: 'GIOVANNI', goLive: '', obs: 'Cliente com revis√£o de escopo', fase: '2. Planejamento', progresso: 15 },
    { id: 'P011', nome: 'DIA', status: 'Atrasado', local: 'S√£o Paulo - SP', prioridade: 'Alta', dataInicio: '2026-01-01', dataPrevista: '2026-01-20', pmo: 'ANDERSON', goLive: '2026-01-20', obs: 'ATEN√á√ÉO: Aguardando retorno cliente sobre VPN', fase: '3. Provisionamento', progresso: 30 },
    { id: 'P012', nome: 'DIAMANTE', status: 'Planejamento', local: 'Curitiba - PR', prioridade: 'M√©dia', dataInicio: '2026-02-15', dataPrevista: '2026-07-30', pmo: 'F√ÅBIO', goLive: '2026-07-30', obs: 'Novo projeto - fase inicial', fase: '1. Inicia√ß√£o', progresso: 0 },
    { id: 'P013', nome: 'ELETRO', status: 'Em andamento', local: 'S√£o Paulo - SP', prioridade: 'M√©dia', dataInicio: '2026-02-01', dataPrevista: '2026-04-20', pmo: 'GIOVANNI', goLive: '2026-04-20', obs: 'Fase de implementa√ß√£o', fase: '4. Implementa√ß√£o', progresso: 35 },
    { id: 'P014', nome: 'ESPERAN√áA', status: 'Conclu√≠do', local: 'Belo Horizonte - MG', prioridade: 'M√©dia', dataInicio: '2025-01-05', dataPrevista: '2026-01-19', pmo: 'VINICIUS', goLive: '2026-01-19', obs: 'Go Live realizado em 19/01/26', fase: '8. Encerramento', progresso: 100 },
    { id: 'P015', nome: 'FLOWER', status: 'Em andamento', local: 'S√£o Paulo - SP', prioridade: 'Baixa', dataInicio: '2026-01-22', dataPrevista: '2026-09-30', pmo: 'ANDERSON', goLive: '2026-09-30', obs: 'Avalia√ß√£o conceitual em andamento', fase: '2. Planejamento', progresso: 10 },
    { id: 'P016', nome: 'GAVI√ÉO', status: 'Conclu√≠do', local: 'Fortaleza - CE', prioridade: 'Alta', dataInicio: '2025-10-01', dataPrevista: '2026-02-28', pmo: 'F√ÅBIO', goLive: '2026-02-01', obs: 'Go Live realizado', fase: '8. Encerramento', progresso: 100 },
    { id: 'P017', nome: 'MKT CHILE', status: 'Planejamento', local: 'Santiago - Chile', prioridade: 'M√©dia', dataInicio: '2026-06-01', dataPrevista: '2026-12-01', pmo: 'ALEX', goLive: '2026-12-01', obs: 'Aguardando Kickoff interno', fase: '1. Inicia√ß√£o', progresso: 0 },
    { id: 'P018', nome: 'MKT PERU', status: 'Planejamento', local: 'Lima - Peru', prioridade: 'M√©dia', dataInicio: '2026-06-01', dataPrevista: '2026-12-01', pmo: 'ALEX', goLive: '2026-12-01', obs: 'Aguardando confirma√ß√£o de pedido', fase: '1. Inicia√ß√£o', progresso: 0 },
    { id: 'P019', nome: 'MASTER', status: 'Planejamento', local: 'S√£o Paulo - SP', prioridade: 'Alta', dataInicio: '2026-03-01', dataPrevista: '2026-09-30', pmo: 'LEANDRO', goLive: '', obs: 'Aguardando defini√ß√£o de requisitos', fase: '1. Inicia√ß√£o', progresso: 0 },
    { id: 'P020', nome: 'NAVEPARK', status: 'Em andamento', local: 'Curitiba - PR', prioridade: 'M√©dia', dataInicio: '2024-12-16', dataPrevista: '2026-06-20', pmo: 'ANDERSON', goLive: '2026-06-23', obs: 'Aguardando pagamento do sinal', fase: '3. Provisionamento', progresso: 25 },
    { id: 'P021', nome: 'OCTOPUS MS', status: 'Em andamento', local: 'Campo Grande - MS', prioridade: 'M√©dia', dataInicio: '2026-01-01', dataPrevista: '2026-06-15', pmo: 'ALEX', goLive: '2026-05-26', obs: 'Go Live previsto para 15/06/26', fase: '4. Implementa√ß√£o', progresso: 40 },
    { id: 'P022', nome: 'OCTOPUS SC', status: 'Conclu√≠do', local: 'Florian√≥polis - SC', prioridade: 'M√©dia', dataInicio: '2025-06-01', dataPrevista: '2025-12-15', pmo: 'ALEX', goLive: '2025-12-15', obs: 'Projeto finalizado', fase: '8. Encerramento', progresso: 100 },
    { id: 'P023', nome: 'OPTIMUS PRIME', status: 'Conclu√≠do', local: 'S√£o Paulo - SP', prioridade: 'Alta', dataInicio: '2025-10-18', dataPrevista: '2025-10-27', pmo: 'GIOVANNI', goLive: '2025-10-27', obs: 'Acompanhamento Assistido OK', fase: '8. Encerramento', progresso: 100 },
    { id: 'P024', nome: 'PBL GUATEMALA', status: 'Em andamento', local: 'Guatemala City', prioridade: 'Alta', dataInicio: '2026-01-10', dataPrevista: '2026-05-15', pmo: 'F√ÅBIO', goLive: '2026-05-15', obs: 'Projeto internacional em andamento', fase: '4. Implementa√ß√£o', progresso: 45 },
    { id: 'P025', nome: 'PROMO B2B CD GRU', status: 'Conclu√≠do', local: 'Guarulhos - SP', prioridade: 'Alta', dataInicio: '2025-05-01', dataPrevista: '2026-02-04', pmo: 'LEANDRO', goLive: '2026-02-04', obs: 'Go Live IA realizado em 04/02/26', fase: '8. Encerramento', progresso: 100 },
    { id: 'P026', nome: 'PTL SP', status: 'Conclu√≠do', local: 'S√£o Paulo - SP', prioridade: 'M√©dia', dataInicio: '2025-04-01', dataPrevista: '2025-10-30', pmo: 'VINICIUS', goLive: '2025-10-30', obs: 'Projeto finalizado', fase: '8. Encerramento', progresso: 100 },
    { id: 'P027', nome: 'REISADO', status: 'Conclu√≠do', local: 'Recife - PE', prioridade: 'M√©dia', dataInicio: '2025-07-01', dataPrevista: '2025-12-20', pmo: 'F√ÅBIO', goLive: '2025-12-20', obs: 'Projeto finalizado', fase: '8. Encerramento', progresso: 100 },
    { id: 'P028', nome: 'REVERSE', status: 'Em andamento', local: 'S√£o Paulo - SP', prioridade: 'Alta', dataInicio: '2025-08-01', dataPrevista: '2026-04-30', pmo: 'ALEX', goLive: '2026-03-15', obs: 'Fase de testes', fase: '5. Testes', progresso: 55 },
    { id: 'P029', nome: 'SUPER DIVINOPOLIS', status: 'Em andamento', local: 'Divin√≥polis - MG', prioridade: 'M√©dia', dataInicio: '2025-09-01', dataPrevista: '2026-03-30', pmo: 'GIOVANNI', goLive: '2026-02-28', obs: 'Em fase de implementa√ß√£o', fase: '4. Implementa√ß√£o', progresso: 50 },
    { id: 'P030', nome: 'TITANIO', status: 'Em andamento', local: 'S√£o Paulo - SP', prioridade: 'Alta', dataInicio: '2025-09-01', dataPrevista: '2026-03-15', pmo: 'ALEX', goLive: '2026-02-15', obs: 'Fase de estabiliza√ß√£o', fase: '7. Estabiliza√ß√£o', progresso: 80 }
];

const hoje = new Date(); hoje.setHours(0,0,0,0);

function calcDiasGoLive(goLive) {
    if (!goLive) return null;
    const [y,m,d] = goLive.split('-').map(Number);
    return Math.round((new Date(y, m-1, d) - hoje) / 86400000);
}

function getAlertaGoLive(p) {
    if (!p.goLive) return { tipo: 'pendente', texto: '‚è≥ Pendente', dias: null };
    const dias = calcDiasGoLive(p.goLive);
    if (dias < 0) return { tipo: 'atrasado', texto: 'üö® ATRASADO', dias };
    if (dias <= 30) return { tipo: 'proximo', texto: '‚ö†Ô∏è PR√ìXIMO', dias };
    return { tipo: 'ok', texto: '‚úÖ OK', dias };
}

function getCorProgresso(p) { return p >= 80 ? 'verde' : p >= 40 ? 'amarelo' : 'vermelho'; }
function formatDate(s) { if (!s) return '-'; const [y,m,d] = s.split('-'); return `${d}/${m}/${y}`; }
function getStatusClass(s) { return s.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/ /g, '-'); }

function renderKPIs() {
    document.getElementById('kpiTotal').textContent = PROJETOS.length;
    document.getElementById('kpiConcluidos').textContent = PROJETOS.filter(p => p.status === 'Conclu√≠do').length;
    document.getElementById('kpiAndamento').textContent = PROJETOS.filter(p => p.status === 'Em andamento').length;
    document.getElementById('kpiPlanejamento').textContent = PROJETOS.filter(p => p.status === 'Planejamento').length;
    document.getElementById('kpiAtrasados').textContent = PROJETOS.filter(p => p.status === 'Atrasado').length;
}

function renderPrioridade() {
    document.getElementById('prioridadeItems').innerHTML = `
        <div class="side-item alta" onclick="filtrarPrioridade('Alta')"><span>Alta</span><span class="count">${PROJETOS.filter(p=>p.prioridade==='Alta').length}</span></div>
        <div class="side-item media" onclick="filtrarPrioridade('M√©dia')"><span>M√©dia</span><span class="count">${PROJETOS.filter(p=>p.prioridade==='M√©dia').length}</span></div>
        <div class="side-item baixa" onclick="filtrarPrioridade('Baixa')"><span>Baixa</span><span class="count">${PROJETOS.filter(p=>p.prioridade==='Baixa').length}</span></div>
    `;
}

function renderPMO() {
    const pmos = ['ALEX', 'ANDERSON', 'F√ÅBIO', 'GIOVANNI', 'LEANDRO', 'VINICIUS'];
    document.getElementById('pmoItems').innerHTML = pmos.map(pmo => 
        `<div class="side-item pmo" onclick="filtrarPMO('${pmo}')"><span>${pmo}</span><span class="count">${PROJETOS.filter(p=>p.pmo===pmo).length}</span></div>`
    ).join('');
    document.getElementById('filtroPMO').innerHTML = '<option value="">Todos</option>' + pmos.map(p => `<option value="${p}">${p}</option>`).join('');
}

function renderAlertasGoLive() {
    const nc = PROJETOS.filter(p => p.status !== 'Conclu√≠do');
    const atrasados = nc.filter(p => getAlertaGoLive(p).tipo === 'atrasado');
    const proximos = nc.filter(p => getAlertaGoLive(p).tipo === 'proximo');
    const pendentes = nc.filter(p => getAlertaGoLive(p).tipo === 'pendente');
    
    document.getElementById('alertasGoLive').innerHTML = `
        <div class="alert-card">
            <div class="alert-card-head vermelho">üö® GO LIVE ATRASADO <span class="badge">${atrasados.length}</span></div>
            <div class="alert-card-body">${atrasados.length ? atrasados.map(p => `<div class="alert-proj vermelho" onclick="abrirModal('${p.nome}')">${p.nome}<span class="dias">${getAlertaGoLive(p).dias}d</span></div>`).join('') : '<div class="alert-empty">Nenhum</div>'}</div>
        </div>
        <div class="alert-card">
            <div class="alert-card-head amarelo">‚ö†Ô∏è GO LIVE EM 30 DIAS <span class="badge">${proximos.length}</span></div>
            <div class="alert-card-body">${proximos.length ? proximos.map(p => `<div class="alert-proj amarelo" onclick="abrirModal('${p.nome}')">${p.nome}<span class="dias">${getAlertaGoLive(p).dias}d</span></div>`).join('') : '<div class="alert-empty">Nenhum</div>'}</div>
        </div>
        <div class="alert-card">
            <div class="alert-card-head cinza">‚è≥ SEM DATA DEFINIDA <span class="badge">${pendentes.length}</span></div>
            <div class="alert-card-body">${pendentes.length ? pendentes.map(p => `<div class="alert-proj cinza" onclick="abrirModal('${p.nome}')">${p.nome}</div>`).join('') : '<div class="alert-empty">Nenhum</div>'}</div>
        </div>
    `;
}

function renderAlertasInfra() {
    const atrasados = PROJETOS.filter(p => p.status === 'Atrasado');
    const emAndamento = PROJETOS.filter(p => p.status === 'Em andamento');
    const planejamento = PROJETOS.filter(p => p.status === 'Planejamento');
    
    document.getElementById('alertasInfra').innerHTML = `
        <div class="alert-card">
            <div class="alert-card-head vermelho">üö® ATRASADO <span class="badge">${atrasados.length}</span></div>
            <div class="alert-card-body">${atrasados.length ? atrasados.map(p => `<div class="alert-proj vermelho" onclick="abrirModal('${p.nome}')">${p.nome}</div>`).join('') : '<div class="alert-empty">Nenhum</div>'}</div>
        </div>
        <div class="alert-card">
            <div class="alert-card-head amarelo">‚ö° EM ANDAMENTO <span class="badge">${emAndamento.length}</span></div>
            <div class="alert-card-body">${emAndamento.slice(0,6).map(p => `<div class="alert-proj amarelo" onclick="abrirModal('${p.nome}')">${p.nome}</div>`).join('')}${emAndamento.length > 6 ? `<div class="alert-empty">+ ${emAndamento.length-6} mais...</div>` : ''}</div>
        </div>
        <div class="alert-card">
            <div class="alert-card-head roxo">üìã PLANEJAMENTO <span class="badge">${planejamento.length}</span></div>
            <div class="alert-card-body">${planejamento.length ? planejamento.map(p => `<div class="alert-proj roxo" onclick="abrirModal('${p.nome}')">${p.nome}</div>`).join('') : '<div class="alert-empty">Nenhum</div>'}</div>
        </div>
    `;
}

function renderProjetos() {
    const fn = document.getElementById('filtroNome').value.toLowerCase();
    const fs = document.getElementById('filtroStatus').value;
    const fp = document.getElementById('filtroPrioridade').value;
    const fm = document.getElementById('filtroPMO').value;
    
    let pf = PROJETOS.filter(p => {
        if (fn && !p.nome.toLowerCase().includes(fn)) return false;
        if (fs && p.status !== fs) return false;
        if (fp && p.prioridade !== fp) return false;
        if (fm && p.pmo !== fm) return false;
        return true;
    });
    
    if (!pf.length) { document.getElementById('projetosGrid').innerHTML = '<div class="empty">Nenhum projeto encontrado.</div>'; return; }
    
    document.getElementById('projetosGrid').innerHTML = pf.map(p => {
        const cor = getCorProgresso(p.progresso);
        const al = getAlertaGoLive(p);
        const glc = al.tipo === 'atrasado' ? 'atrasado' : al.tipo === 'proximo' ? 'proximo' : '';
        return `
            <div class="project-card ${cor}" onclick="abrirModal('${p.nome}')">
                <div class="project-header"><span class="project-name">${p.nome}</span><span class="priority ${p.prioridade.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'')}">${p.prioridade}</span></div>
                <div class="project-meta"><span>üìç ${p.local}</span><span>üë§ ${p.pmo}</span></div>
                <div class="project-phase">${p.fase}</div>
                <div class="progress"><div class="progress-header"><span>Progresso</span><strong>${p.progresso}%</strong></div><div class="progress-bar"><div class="progress-fill ${cor}" style="width:${p.progresso}%"></div></div></div>
                <div class="project-footer"><span class="status-badge ${getStatusClass(p.status)}">${p.status}</span><span class="go-live-info ${glc}">Go Live: ${formatDate(p.goLive)||'A definir'}</span></div>
            </div>
        `;
    }).join('');
}

function filtrarStatus(s) { document.getElementById('filtroStatus').value = s; renderProjetos(); }
function filtrarPrioridade(p) { document.getElementById('filtroPrioridade').value = p; renderProjetos(); }
function filtrarPMO(m) { document.getElementById('filtroPMO').value = m; renderProjetos(); }
function limparFiltros() { ['filtroNome','filtroStatus','filtroPrioridade','filtroPMO'].forEach(id => document.getElementById(id).value = ''); renderProjetos(); }
function setView(t) { document.getElementById('btnCards').classList.toggle('active', t==='cards'); document.getElementById('btnLista').classList.toggle('active', t==='lista'); }

function abrirModal(nome) {
    const p = PROJETOS.find(x => x.nome === nome); if (!p) return;
    const al = getAlertaGoLive(p);
    document.getElementById('modalTitle').textContent = `üìã ${p.nome}`;
    document.getElementById('modalBody').innerHTML = `
        <div class="modal-info">
            <div class="modal-info-item"><span class="label">Status</span><span class="value">${p.status}</span></div>
            <div class="modal-info-item"><span class="label">Fase</span><span class="value">${p.fase}</span></div>
            <div class="modal-info-item"><span class="label">Progresso</span><span class="value">${p.progresso}%</span></div>
            <div class="modal-info-item"><span class="label">Prioridade</span><span class="value">${p.prioridade}</span></div>
            <div class="modal-info-item"><span class="label">PMO</span><span class="value">${p.pmo}</span></div>
            <div class="modal-info-item"><span class="label">Local</span><span class="value">${p.local}</span></div>
            <div class="modal-info-item"><span class="label">Go Live</span><span class="value ${al.tipo==='atrasado'?'danger':''}">${formatDate(p.goLive)||'A definir'}</span></div>
            <div class="modal-info-item"><span class="label">Alerta</span><span class="value ${al.tipo==='atrasado'?'danger':''}">${al.texto}${al.dias!==null?` (${al.dias}d)`:''}</span></div>
        </div>
        <div class="modal-obs"><strong>üìù Observa√ß√µes</strong><p>${p.obs}</p></div>
        <div class="modal-dates"><div><span>Data In√≠cio:</span> <strong>${formatDate(p.dataInicio)}</strong></div><div><span>T√©rmino Previsto:</span> <strong>${formatDate(p.dataPrevista)}</strong></div></div>
    `;
    document.getElementById('modal').classList.add('show');
}

function fecharModal(e) { if (!e || e.target === document.getElementById('modal')) document.getElementById('modal').classList.remove('show'); }
function restaurarV76() { if (confirm('‚ö†Ô∏è Restaurar vers√£o 7.6?\n\nOs arquivos da v7.6 est√£o em:\n/home/claude/BACKUP_WEB_V76_ESTAVEL/')) alert('Solicite ao administrador para restaurar.'); }

document.getElementById('dataAtual').textContent = hoje.toLocaleDateString('pt-BR', { weekday: 'long', day: '2-digit', month: 'long', year: 'numeric' });
document.getElementById('timestamp').textContent = 'Atualizado: ' + new Date().toLocaleString('pt-BR');

renderKPIs(); renderPrioridade(); renderPMO(); renderAlertasGoLive(); renderAlertasInfra(); renderProjetos();
document.addEventListener('keydown', e => { if (e.key === 'Escape') fecharModal(); });
</script>
</body>
</html>
