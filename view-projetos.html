<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Alertas & Projetos v9</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }

.container { max-width: 1400px; margin: 0 auto; background: white; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); overflow: hidden; }

/* ===== HEADER (padr√£o Detalhada) ===== */
.header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px 25px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; }
.header-left h1 { font-size: 1.4em; display: flex; align-items: center; gap: 10px; }
.header-left p { opacity: 0.9; font-size: 0.85em; margin-top: 4px; }
.nav-buttons { display: flex; gap: 8px; flex-wrap: wrap; }
.nav-btn { padding: 10px 18px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.9em; text-decoration: none; display: inline-flex; align-items: center; gap: 6px; transition: all 0.2s; color: white; }
.nav-btn.orange { background: #f59e0b; }
.nav-btn.orange:hover { background: #d97706; }
.nav-btn.purple { background: #8b5cf6; }
.nav-btn.purple:hover { background: #7c3aed; }
.nav-btn.green { background: #22c55e; }
.nav-btn.green:hover { background: #16a34a; }
.nav-btn.blue { background: #3b82f6; }
.nav-btn.blue:hover { background: #2563eb; }

.content { padding: 20px 25px; }

/* ===== KPIs DE RISCO (novo bloco no topo) ===== */
.risk-kpis { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 20px; }
.risk-kpi { padding: 18px 20px; border-radius: 12px; color: white; position: relative; overflow: hidden; cursor: pointer; transition: all 0.2s; }
.risk-kpi:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
.risk-kpi.active { outline: 3px solid #1e293b; outline-offset: 2px; transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.3); }
.risk-kpi::after { content: ''; position: absolute; top: -20px; right: -20px; width: 80px; height: 80px; background: rgba(255,255,255,0.1); border-radius: 50%; }
.risk-kpi .icon { font-size: 1.8em; margin-bottom: 8px; }
.risk-kpi .value { font-size: 2.2em; font-weight: 800; line-height: 1; }
.risk-kpi .label { font-size: 0.82em; opacity: 0.92; margin-top: 4px; font-weight: 500; }
.risk-kpi.verde { background: linear-gradient(135deg, #059669, #047857); }
.risk-kpi.amarelo { background: linear-gradient(135deg, #d97706, #b45309); }
.risk-kpi.laranja { background: linear-gradient(135deg, #ea580c, #c2410c); }
.risk-kpi.vermelho { background: linear-gradient(135deg, #dc2626, #991b1b); }

/* ===== CARDS LATERAIS (Prioridade + PMO) ===== */
.side-cards-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px; }
@media(max-width:600px) { .side-cards-row { grid-template-columns: 1fr; } }

.side-card { background: #f8fafc; border-radius: 10px; padding: 12px 15px; border: 1px solid #e2e8f0; }
.side-card h4 { font-size: 0.8em; color: #64748b; margin-bottom: 8px; }
.side-item { display: flex; justify-content: space-between; padding: 6px 10px; border-radius: 6px; font-size: 0.85em; cursor: pointer; margin-bottom: 4px; font-weight: 500; transition: transform 0.2s; }
.side-item:hover { transform: translateX(3px); }
.side-item.alta { background: #fef2f2; color: #dc2626; }
.side-item.media { background: #fffbeb; color: #b45309; }
.side-item.baixa { background: #f0fdf4; color: #16a34a; }
.side-item.pmo { background: #f1f5f9; color: #475569; }
.side-item .count { font-weight: 700; }

/* ===== ALERTAS ===== */
.alerts-section { margin-bottom: 20px; }
.alert-header { padding: 12px 18px; border-radius: 10px 10px 0 0; color: white; font-weight: 600; display: flex; justify-content: space-between; flex-wrap: wrap; align-items: center; }
.alert-header.douglas { background: linear-gradient(135deg, #1e293b, #334155); }
.alert-header.daiana { background: linear-gradient(135deg, #ea580c, #c2410c); }
.alert-header small { opacity: 0.85; font-weight: 400; }
.alert-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 12px; padding: 15px; background: #f8fafc; border-radius: 0 0 10px 10px; border: 1px solid #e2e8f0; border-top: none; }
.alert-card { background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
.alert-card-head { padding: 10px 12px; color: white; font-weight: 600; font-size: 0.85em; display: flex; justify-content: space-between; }
.alert-card-head.vermelho { background: #ef4444; }
.alert-card-head.amarelo { background: #f59e0b; }
.alert-card-head.cinza { background: #64748b; }
.alert-card-head.roxo { background: #8b5cf6; }
.alert-card-head.azul { background: #3b82f6; }
.alert-card-head .badge { background: rgba(255,255,255,0.25); padding: 2px 8px; border-radius: 10px; }
.alert-card-body { padding: 10px; max-height: 150px; overflow-y: auto; }
.alert-proj { padding: 6px 10px; margin-bottom: 4px; border-radius: 6px; font-size: 0.85em; cursor: pointer; display: flex; justify-content: space-between; font-weight: 500; transition: transform 0.2s; }
.alert-proj:hover { transform: translateX(3px); }
.alert-proj.vermelho { background: #fef2f2; color: #dc2626; }
.alert-proj.amarelo { background: #fffbeb; color: #92400e; }
.alert-proj.cinza { background: #f1f5f9; color: #64748b; }
.alert-proj.roxo { background: #f5f3ff; color: #6d28d9; }
.alert-proj.azul { background: #eff6ff; color: #1d4ed8; }
.alert-proj .dias { font-size: 0.8em; opacity: 0.8; }
.alert-empty { color: #94a3b8; font-size: 0.85em; padding: 15px; text-align: center; }

/* ===== FILTROS ===== */
.filters { display: grid; grid-template-columns: 2fr repeat(3, 1fr) auto; gap: 12px; margin-bottom: 18px; padding: 15px; background: #f8fafc; border-radius: 10px; border: 1px solid #e2e8f0; align-items: end; }
.filter-group label { display: block; font-size: 0.78em; color: #64748b; margin-bottom: 4px; font-weight: 600; }
.filter-group input, .filter-group select { width: 100%; padding: 9px 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 0.9em; transition: border 0.2s; }
.filter-group input:focus, .filter-group select:focus { outline: none; border-color: #667eea; }
.btn-limpar { padding: 9px 16px; background: #f1f5f9; border: 2px solid #e2e8f0; color: #64748b; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.2s; }
.btn-limpar:hover { background: #e2e8f0; border-color: #cbd5e1; }

/* ===== PROJETOS GRID ===== */
.projects-title { font-size: 1.1em; color: #1e293b; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; }
.projects-title .count-badge { background: #667eea; color: white; padding: 2px 12px; border-radius: 12px; font-size: 0.82em; }
.projects { display: grid; grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)); gap: 15px; }

.project-card { background: white; border: 1px solid #e2e8f0; border-radius: 10px; padding: 15px; cursor: pointer; transition: all 0.2s; border-left: 4px solid #e2e8f0; position: relative; }
.project-card:hover { box-shadow: 0 5px 20px rgba(0,0,0,0.1); transform: translateY(-2px); }
.project-card.verde { border-left-color: #22c55e; }
.project-card.amarelo { border-left-color: #f59e0b; }
.project-card.vermelho { border-left-color: #ef4444; }

.project-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px; gap: 8px; }
.project-name { font-weight: 700; color: #1e293b; font-size: 0.95em; }
.project-badges { display: flex; gap: 5px; flex-wrap: wrap; }

.priority { padding: 3px 8px; border-radius: 4px; font-size: 0.7em; font-weight: 700; }
.priority.alta { background: #fee2e2; color: #dc2626; }
.priority.media { background: #fef3c7; color: #d97706; }
.priority.baixa { background: #dcfce7; color: #16a34a; }

.risk-badge { padding: 3px 8px; border-radius: 4px; font-size: 0.7em; font-weight: 700; }
.risk-badge.alto { background: #dc2626; color: white; }
.risk-badge.medio { background: #f59e0b; color: white; }
.risk-badge.baixo { background: #22c55e; color: white; }

.alert-badge-tag { padding: 2px 7px; border-radius: 4px; font-size: 0.65em; font-weight: 700; background: #7c3aed; color: white; }

.project-meta { display: flex; gap: 12px; font-size: 0.82em; color: #64748b; margin-bottom: 8px; flex-wrap: wrap; }
.project-phase { background: #eff6ff; color: #1d4ed8; padding: 5px 10px; border-radius: 6px; font-size: 0.8em; margin-bottom: 8px; display: inline-block; font-weight: 600; }

.progress { margin-bottom: 10px; }
.progress-header { display: flex; justify-content: space-between; font-size: 0.85em; margin-bottom: 4px; }
.progress-bar { height: 6px; background: #e2e8f0; border-radius: 3px; overflow: hidden; }
.progress-fill { height: 100%; border-radius: 3px; transition: width 0.3s; }
.progress-fill.verde { background: #22c55e; }
.progress-fill.amarelo { background: #f59e0b; }
.progress-fill.vermelho { background: #ef4444; }

.project-footer { display: flex; justify-content: space-between; align-items: center; }
.status-badge { padding: 4px 10px; border-radius: 5px; font-size: 0.75em; font-weight: 600; }
.status-badge.concluido { background: #dcfce7; color: #166534; }
.status-badge.em-andamento { background: #dbeafe; color: #1e40af; }
.status-badge.planejamento { background: #f3e8ff; color: #7c3aed; }
.status-badge.atrasado { background: #fee2e2; color: #991b1b; }
.go-live-info { font-size: 0.8em; color: #64748b; }
.go-live-info.atrasado { color: #dc2626; font-weight: 600; }
.go-live-info.proximo { color: #d97706; font-weight: 600; }

/* ===== MODAL ===== */
.modal-bg { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center; padding: 20px; }
.modal-bg.show { display: flex; }
.modal { background: white; border-radius: 12px; max-width: 600px; width: 100%; max-height: 80vh; overflow: hidden; }
.modal-head { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; }
.modal-head h2 { font-size: 1.1em; }
.modal-close { background: rgba(255,255,255,0.2); border: none; color: white; width: 32px; height: 32px; border-radius: 50%; cursor: pointer; font-size: 1.3em; transition: background 0.2s; }
.modal-close:hover { background: rgba(255,255,255,0.3); }
.modal-body { padding: 20px; overflow-y: auto; max-height: calc(80vh - 60px); }
.modal-info { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 15px; }
.modal-info-item .label { color: #64748b; font-size: 0.8em; }
.modal-info-item .value { color: #1e293b; font-weight: 600; }
.modal-obs { background: #f8fafc; padding: 12px; border-radius: 8px; border-left: 4px solid #667eea; }
.modal-obs strong { color: #64748b; font-size: 0.85em; display: block; margin-bottom: 6px; }

/* ===== FOOTER ===== */
.footer { text-align: center; padding: 15px; background: #f8fafc; border-top: 1px solid #e2e8f0; font-size: 0.8em; color: #64748b; }

/* ===== RESPONSIVO ===== */
@media(max-width: 900px) {
    .risk-kpis { grid-template-columns: repeat(2, 1fr); }
    .side-cards-row { grid-template-columns: 1fr 1fr; }
    .filters { grid-template-columns: 1fr 1fr; }
    .projects { grid-template-columns: 1fr; }
}
@media(max-width: 600px) {
    .risk-kpis { grid-template-columns: 1fr; }
    .side-cards-row { grid-template-columns: 1fr; }
    .filters { grid-template-columns: 1fr; }
    .header { flex-direction: column; text-align: center; }
}
@media print {
    body { background: white !important; padding: 0 !important; }
    .container { box-shadow: none !important; }
    .nav-buttons, .filters, .filter-indicator { display: none !important; }
    .header { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .risk-kpis { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .risk-kpi { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .alert-card-head { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .alert-header { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .project-card { break-inside: avoid; }
    .alerts-section { break-inside: avoid; }
    .progress-fill { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .status-badge { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
}
</style>
</head>
<body>
<div class="container">

<!-- HEADER (padr√£o Detalhada) -->
<header class="header">
    <div class="header-left">
        <h1>üìä Alertas & Projetos v9</h1>
        <p>Vis√£o de Risco e Acompanhamento | Atualizado: <span id="dataAtual"></span></p>
    </div>
    <nav class="nav-buttons">
        <a href="index.html" class="nav-btn orange">üè† Vis√£o Executiva</a>
        <a href="view-detalhada.html" class="nav-btn purple">üìã Detalhada</a>
        <a href="view-simples.html" class="nav-btn green">üìÑ Resumida</a>
        <button class="nav-btn blue" onclick="window.print()">üñ®Ô∏è Imprimir</button>
    </nav>
</header>

<main class="content">

<!-- KPIs DE RISCO (novo bloco) -->
<div class="risk-kpis">
    <div class="risk-kpi verde" id="kpiNoPrazo" onclick="filtrarRisco('noprazo')">
        <div class="icon">‚úÖ</div>
        <div class="value" id="riskNoPrazo">0</div>
        <div class="label">No Prazo</div>
    </div>
    <div class="risk-kpi amarelo" id="kpiGoLive" onclick="filtrarRisco('golive')">
        <div class="icon">‚ö†Ô∏è</div>
        <div class="value" id="riskGoLive">0</div>
        <div class="label">Go Lives em Risco</div>
    </div>
    <div class="risk-kpi laranja" id="kpiInfra" onclick="filtrarRisco('infra')">
        <div class="icon">üîß</div>
        <div class="value" id="riskInfra">0</div>
        <div class="label">Alertas Infra</div>
    </div>
    <div class="risk-kpi vermelho" id="kpiCriticos" onclick="filtrarRisco('criticos')">
        <div class="icon">üö®</div>
        <div class="value" id="riskCriticos">0</div>
        <div class="label">Cr√≠ticos</div>
    </div>
</div>

<!-- CARDS LATERAIS (Prioridade + PMO) -->
<div class="side-cards-row">
    <div class="side-card"><h4>‚ö° Prioridade</h4><div id="prioridadeItems"></div></div>
    <div class="side-card"><h4>üë§ PMO</h4><div id="pmoItems"></div></div>
</div>

<!-- ALERTAS GO LIVE (Douglas) -->
<div class="alerts-section">
    <div class="alert-header douglas">
        <span>üéØ ALERTAS GO LIVE (Douglas)</span>
        <small>Baseado na DATA do Go Live</small>
    </div>
    <div class="alert-cards" id="alertasGoLive"></div>
</div>

<!-- ALERTAS INFRA (Daiana) -->
<div class="alerts-section">
    <div class="alert-header daiana">
        <span>üîß ALERTAS INFRA (Daiana)</span>
        <small>Baseado no STATUS do trabalho</small>
    </div>
    <div class="alert-cards" id="alertasInfra"></div>
</div>

<!-- FILTROS -->
<div class="filters">
    <div class="filter-group">
        <label>üîç Buscar Projeto</label>
        <input type="text" id="filtroNome" placeholder="Nome do projeto..." oninput="renderAll()">
    </div>
    <div class="filter-group">
        <label>üìä Status</label>
        <select id="filtroStatus" onchange="renderAll()">
            <option value="">Todos</option>
            <option value="Conclu√≠do">Conclu√≠do</option>
            <option value="Em andamento">Em andamento</option>
            <option value="Planejamento">Planejamento</option>
            <option value="Atrasado">Atrasado</option>
        </select>
    </div>
    <div class="filter-group">
        <label>‚ö° Prioridade</label>
        <select id="filtroPrioridade" onchange="renderAll()">
            <option value="">Todas</option>
            <option value="Alta">Alta</option>
            <option value="M√©dia">M√©dia</option>
            <option value="Baixa">Baixa</option>
        </select>
    </div>
    <div class="filter-group">
        <label>üë§ PMO</label>
        <select id="filtroPMO" onchange="renderAll()">
            <option value="">Todos</option>
            <option>ALEX</option><option>ANDERSON</option><option>F√ÅBIO</option>
            <option>GIOVANNI</option><option>LEANDRO</option><option>VINICIUS</option>
        </select>
    </div>
    <div class="filter-group">
        <label>&nbsp;</label>
        <button class="btn-limpar" onclick="limparFiltros()">üóëÔ∏è Limpar</button>
    </div>
</div>

<!-- PROJETOS -->
<div class="projects-title">üìÅ Projetos <span class="count-badge" id="projetosCount">0</span> <span id="filtroAtivoLabel" style="font-size:0.75em;color:#94a3b8;margin-left:8px;">Ordenados por n√≠vel de risco</span></div>
<div class="projects" id="projetosGrid"></div>

</main>

<footer class="footer">Alertas & Projetos v9 | Invent Corp | Dashboard de Infraestrutura</footer>
</div>

<!-- MODAL -->
<div class="modal-bg" id="modal" onclick="fecharModal()">
    <div class="modal" onclick="event.stopPropagation()">
        <div class="modal-head">
            <h2 id="modalTitle">Projeto</h2>
            <button class="modal-close" onclick="fecharModal()">√ó</button>
        </div>
        <div class="modal-body" id="modalBody"></div>
    </div>
</div>

<script>
// ===== DADOS DOS PROJETOS =====
const PROJETOS = [
    {nome:"BARBECUE B2B",status:"Conclu√≠do",local:"S√£o Paulo - SP",prioridade:"Alta",pmo:"ALEX",goLive:"2026-02-06",obs:"Acompanhamento Assistido",fase:"8. Encerramento",progresso:100},
    {nome:"BELEZA",status:"Conclu√≠do",local:"S√£o Paulo - SP",prioridade:"M√©dia",pmo:"ANDERSON",goLive:"2025-11-30",obs:"Projeto finalizado",fase:"8. Encerramento",progresso:100},
    {nome:"BETA",status:"Conclu√≠do",local:"Rio de Janeiro - RJ",prioridade:"Alta",pmo:"ANDERSON",goLive:"2026-03-10",obs:"Go Live realizado",fase:"8. Encerramento",progresso:100},
    {nome:"BETA ESTEIO",status:"Planejamento",local:"Esteio - RS",prioridade:"M√©dia",pmo:"ANDERSON",goLive:"2026-08-17",obs:"Kickoff realizado 16/01",fase:"1. Inicia√ß√£o",progresso:5},
    {nome:"BP",status:"Em andamento",local:"S√£o Paulo - SP",prioridade:"M√©dia",pmo:"GIOVANNI",goLive:"2026-06-23",obs:"Aguardando escopo",fase:"2. Planejamento",progresso:15},
    {nome:"BR",status:"Planejamento",local:"Jaboat√£o - PE",prioridade:"Alta",pmo:"F√ÅBIO",goLive:"",obs:"Aguardando Kickoff",fase:"1. Inicia√ß√£o",progresso:5},
    {nome:"CANDELABRIA",status:"Conclu√≠do",local:"Candel√°ria - RS",prioridade:"M√©dia",pmo:"ALEX",goLive:"2025-12-09",obs:"Go Live 09/12",fase:"8. Encerramento",progresso:100},
    {nome:"CDSK",status:"Em andamento",local:"S√£o Paulo - SP",prioridade:"Alta",pmo:"VINICIUS",goLive:"2026-02-10",obs:"Go Live Fase 1",fase:"6. Deploy",progresso:75},
    {nome:"COUGAR",status:"Conclu√≠do",local:"S√£o Paulo - SP",prioridade:"Alta",pmo:"LEANDRO",goLive:"2026-02-09",obs:"Go Live B2B 09/02",fase:"8. Encerramento",progresso:100},
    {nome:"CRISTAL MG RETROFIT",status:"Em andamento",local:"Belo Horizonte - MG",prioridade:"Alta",pmo:"GIOVANNI",goLive:"",obs:"Revis√£o de escopo",fase:"2. Planejamento",progresso:15},
    {nome:"DIA",status:"Atrasado",local:"S√£o Paulo - SP",prioridade:"Alta",pmo:"ANDERSON",goLive:"2026-01-20",obs:"ATEN√á√ÉO: VPN pendente",fase:"3. Provisionamento",progresso:30},
    {nome:"DIAMANTE",status:"Planejamento",local:"Curitiba - PR",prioridade:"M√©dia",pmo:"F√ÅBIO",goLive:"2026-07-30",obs:"Novo projeto",fase:"1. Inicia√ß√£o",progresso:0},
    {nome:"ELETRO",status:"Em andamento",local:"S√£o Paulo - SP",prioridade:"M√©dia",pmo:"GIOVANNI",goLive:"2026-04-20",obs:"Implementa√ß√£o",fase:"4. Implementa√ß√£o",progresso:35},
    {nome:"ESPERAN√áA",status:"Conclu√≠do",local:"Belo Horizonte - MG",prioridade:"M√©dia",pmo:"VINICIUS",goLive:"2026-01-19",obs:"Go Live 19/01",fase:"8. Encerramento",progresso:100},
    {nome:"FLOWER",status:"Em andamento",local:"S√£o Paulo - SP",prioridade:"Baixa",pmo:"ANDERSON",goLive:"2026-09-30",obs:"Avalia√ß√£o conceitual",fase:"2. Planejamento",progresso:10},
    {nome:"GAVI√ÉO",status:"Conclu√≠do",local:"Fortaleza - CE",prioridade:"Alta",pmo:"F√ÅBIO",goLive:"2026-02-01",obs:"Go Live realizado",fase:"8. Encerramento",progresso:100},
    {nome:"MKT CHILE",status:"Planejamento",local:"Santiago - Chile",prioridade:"M√©dia",pmo:"ALEX",goLive:"2026-12-01",obs:"Aguardando Kickoff",fase:"1. Inicia√ß√£o",progresso:0},
    {nome:"MKT PERU",status:"Planejamento",local:"Lima - Peru",prioridade:"M√©dia",pmo:"ALEX",goLive:"2026-12-01",obs:"Aguardando pedido",fase:"1. Inicia√ß√£o",progresso:0},
    {nome:"MASTER",status:"Planejamento",local:"S√£o Paulo - SP",prioridade:"Alta",pmo:"LEANDRO",goLive:"",obs:"Aguardando requisitos",fase:"1. Inicia√ß√£o",progresso:0},
    {nome:"NAVEPARK",status:"Em andamento",local:"Curitiba - PR",prioridade:"M√©dia",pmo:"ANDERSON",goLive:"2026-06-23",obs:"Aguardando sinal",fase:"3. Provisionamento",progresso:25},
    {nome:"OCTOPUS MS",status:"Em andamento",local:"Campo Grande - MS",prioridade:"M√©dia",pmo:"ALEX",goLive:"2026-05-26",obs:"Go Live 15/06",fase:"4. Implementa√ß√£o",progresso:40},
    {nome:"OCTOPUS SC",status:"Conclu√≠do",local:"Florian√≥polis - SC",prioridade:"M√©dia",pmo:"ALEX",goLive:"2025-12-15",obs:"Finalizado",fase:"8. Encerramento",progresso:100},
    {nome:"OPTIMUS PRIME",status:"Conclu√≠do",local:"S√£o Paulo - SP",prioridade:"Alta",pmo:"GIOVANNI",goLive:"2025-10-27",obs:"Assistido OK",fase:"8. Encerramento",progresso:100},
    {nome:"PBL GUATEMALA",status:"Em andamento",local:"Guatemala City",prioridade:"Alta",pmo:"F√ÅBIO",goLive:"2026-05-15",obs:"Internacional",fase:"4. Implementa√ß√£o",progresso:45},
    {nome:"PROMO B2B CD GRU",status:"Conclu√≠do",local:"Guarulhos - SP",prioridade:"Alta",pmo:"LEANDRO",goLive:"2026-02-04",obs:"Go Live IA 04/02",fase:"8. Encerramento",progresso:100},
    {nome:"PTL SP",status:"Conclu√≠do",local:"S√£o Paulo - SP",prioridade:"M√©dia",pmo:"VINICIUS",goLive:"2025-10-30",obs:"Finalizado",fase:"8. Encerramento",progresso:100},
    {nome:"REISADO",status:"Conclu√≠do",local:"Recife - PE",prioridade:"M√©dia",pmo:"F√ÅBIO",goLive:"2025-12-20",obs:"Finalizado",fase:"8. Encerramento",progresso:100},
    {nome:"REVERSE",status:"Em andamento",local:"S√£o Paulo - SP",prioridade:"Alta",pmo:"ALEX",goLive:"2026-03-15",obs:"Fase de testes",fase:"5. Testes",progresso:55},
    {nome:"SUPER DIVINOPOLIS",status:"Em andamento",local:"Divin√≥polis - MG",prioridade:"M√©dia",pmo:"GIOVANNI",goLive:"2026-02-28",obs:"Implementa√ß√£o",fase:"4. Implementa√ß√£o",progresso:50},
    {nome:"TITANIO",status:"Em andamento",local:"S√£o Paulo - SP",prioridade:"Alta",pmo:"ALEX",goLive:"2026-02-15",obs:"Estabiliza√ß√£o",fase:"7. Estabiliza√ß√£o",progresso:80}
];

const hoje = new Date(); hoje.setHours(0,0,0,0);

// ===== FUN√á√ïES AUXILIARES =====
function calcDiasGoLive(gl) {
    if (!gl) return null;
    const [y,m,d] = gl.split("-").map(Number);
    return Math.round((new Date(y, m-1, d) - hoje) / 86400000);
}

function getAlertaGoLive(p) {
    if (!p.goLive) return { tipo: "pendente", dias: null };
    const dias = calcDiasGoLive(p.goLive);
    if (dias < 0) return { tipo: "atrasado", dias };
    if (dias <= 30) return { tipo: "proximo", dias };
    return { tipo: "ok", dias };
}

function getCorProgresso(p) { return p >= 80 ? "verde" : p >= 40 ? "amarelo" : "vermelho"; }
function formatDate(s) { if (!s) return "-"; const [y,m,d] = s.split("-"); return `${d}/${m}/${y}`; }
function getStatusClass(s) { return s.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/ /g,"-"); }

// ===== C√ÅLCULO DE RISCO =====
function calcRisco(p) {
    if (p.status === "Conclu√≠do") return { nivel: "ok", score: 0, label: "" };
    
    let score = 0;
    const al = getAlertaGoLive(p);
    
    // Go Live atrasado = +40
    if (al.tipo === "atrasado") score += 40;
    // Go Live em 30 dias = +25
    else if (al.tipo === "proximo") score += 25;
    // Sem data de Go Live = +10
    else if (al.tipo === "pendente") score += 10;
    
    // Status Atrasado = +30
    if (p.status === "Atrasado") score += 30;
    
    // Progresso baixo = +15
    if (p.progresso < 30 && p.status !== "Planejamento") score += 15;
    
    // Prioridade Alta = +10
    if (p.prioridade === "Alta") score += 10;
    
    if (score >= 40) return { nivel: "alto", score, label: "üî¥ Alto" };
    if (score >= 20) return { nivel: "medio", score, label: "üü† M√©dio" };
    if (score > 0) return { nivel: "baixo", score, label: "üü¢ Baixo" };
    return { nivel: "ok", score: 0, label: "" };
}

function isAlertaInfra(p) {
    return p.status === "Atrasado" || 
           (p.status === "Em andamento" && p.progresso < 40) ||
           (p.status !== "Conclu√≠do" && !p.goLive);
}

// ===== RENDER KPIs DE RISCO =====
function renderRiskKPIs() {
    const nc = PROJETOS.filter(p => p.status !== "Conclu√≠do");
    
    const noPrazo = nc.filter(p => {
        const al = getAlertaGoLive(p);
        return al.tipo === "ok" && p.status !== "Atrasado";
    }).length;
    
    const goLiveRisco = nc.filter(p => {
        const al = getAlertaGoLive(p);
        return al.tipo === "atrasado" || al.tipo === "proximo";
    }).length;
    
    const alertaInfra = nc.filter(p => isAlertaInfra(p)).length;
    
    const criticos = nc.filter(p => calcRisco(p).nivel === "alto").length;
    
    document.getElementById("riskNoPrazo").textContent = noPrazo;
    document.getElementById("riskGoLive").textContent = goLiveRisco;
    document.getElementById("riskInfra").textContent = alertaInfra;
    document.getElementById("riskCriticos").textContent = criticos;
}

// ===== RENDER PRIORIDADE =====
function renderPrioridade() {
    document.getElementById("prioridadeItems").innerHTML = `
        <div class="side-item alta" onclick="filtrarPrioridade('Alta')"><span>Alta</span><span class="count">${PROJETOS.filter(p => p.prioridade === "Alta").length}</span></div>
        <div class="side-item media" onclick="filtrarPrioridade('M√©dia')"><span>M√©dia</span><span class="count">${PROJETOS.filter(p => p.prioridade === "M√©dia").length}</span></div>
        <div class="side-item baixa" onclick="filtrarPrioridade('Baixa')"><span>Baixa</span><span class="count">${PROJETOS.filter(p => p.prioridade === "Baixa").length}</span></div>`;
}

// ===== RENDER PMO =====
function renderPMO() {
    const pmos = ["ALEX","ANDERSON","F√ÅBIO","GIOVANNI","LEANDRO","VINICIUS"];
    document.getElementById("pmoItems").innerHTML = pmos.map(pmo => 
        `<div class="side-item pmo" onclick="filtrarPMO('${pmo}')"><span>${pmo}</span><span class="count">${PROJETOS.filter(p => p.pmo === pmo).length}</span></div>`
    ).join("");
}

// ===== PROJETOS FILTRADOS (base para alertas e grid) =====
function getProjetosFiltrados() {
    const fn = document.getElementById("filtroNome").value.toLowerCase();
    const fs = document.getElementById("filtroStatus").value;
    const fp = document.getElementById("filtroPrioridade").value;
    const fm = document.getElementById("filtroPMO").value;
    
    return PROJETOS.filter(p => {
        if (fn && !p.nome.toLowerCase().includes(fn)) return false;
        if (fs && p.status !== fs) return false;
        if (fp && p.prioridade !== fp) return false;
        if (fm && p.pmo !== fm) return false;
        return true;
    });
}

// ===== RENDER ALERTAS GO LIVE =====
function renderAlertasGoLive() {
    const base = getProjetosFiltrados();
    const nc = base.filter(p => p.status !== "Conclu√≠do");
    const atrasados = nc.filter(p => getAlertaGoLive(p).tipo === "atrasado");
    const proximos = nc.filter(p => getAlertaGoLive(p).tipo === "proximo");
    const pendentes = nc.filter(p => getAlertaGoLive(p).tipo === "pendente");
    
    document.getElementById("alertasGoLive").innerHTML = `
        <div class="alert-card">
            <div class="alert-card-head vermelho">üö® GO LIVE ATRASADO <span class="badge">${atrasados.length}</span></div>
            <div class="alert-card-body">${atrasados.length ? atrasados.map(p => `<div class="alert-proj vermelho" onclick="abrirModal('${p.nome}')">${p.nome}<span class="dias">${getAlertaGoLive(p).dias}d</span></div>`).join("") : '<div class="alert-empty">Nenhum</div>'}</div>
        </div>
        <div class="alert-card">
            <div class="alert-card-head amarelo">‚ö†Ô∏è EM 30 DIAS <span class="badge">${proximos.length}</span></div>
            <div class="alert-card-body">${proximos.length ? proximos.map(p => `<div class="alert-proj amarelo" onclick="abrirModal('${p.nome}')">${p.nome}<span class="dias">${getAlertaGoLive(p).dias}d</span></div>`).join("") : '<div class="alert-empty">Nenhum</div>'}</div>
        </div>
        <div class="alert-card">
            <div class="alert-card-head cinza">‚è≥ SEM DATA <span class="badge">${pendentes.length}</span></div>
            <div class="alert-card-body">${pendentes.length ? pendentes.map(p => `<div class="alert-proj cinza" onclick="abrirModal('${p.nome}')">${p.nome}</div>`).join("") : '<div class="alert-empty">Nenhum</div>'}</div>
        </div>`;
}

// ===== RENDER ALERTAS INFRA =====
function renderAlertasInfra() {
    const base = getProjetosFiltrados();
    const nc = base.filter(p => p.status !== "Conclu√≠do");
    const bloqueados = nc.filter(p => p.status === "Atrasado");
    const emRisco = nc.filter(p => p.status === "Em andamento" && p.progresso < 40);
    const atencao = nc.filter(p => p.status === "Em andamento" && p.progresso >= 40 && p.progresso < 70);
    
    document.getElementById("alertasInfra").innerHTML = `
        <div class="alert-card">
            <div class="alert-card-head vermelho">üõë BLOQUEADO <span class="badge">${bloqueados.length}</span></div>
            <div class="alert-card-body">${bloqueados.length ? bloqueados.map(p => `<div class="alert-proj vermelho" onclick="abrirModal('${p.nome}')">${p.nome}</div>`).join("") : '<div class="alert-empty">Nenhum</div>'}</div>
        </div>
        <div class="alert-card">
            <div class="alert-card-head amarelo">‚ö†Ô∏è EM RISCO <span class="badge">${emRisco.length}</span></div>
            <div class="alert-card-body">${emRisco.length ? emRisco.map(p => `<div class="alert-proj amarelo" onclick="abrirModal('${p.nome}')">${p.nome}<span class="dias">${p.progresso}%</span></div>`).join("") : '<div class="alert-empty">Nenhum</div>'}</div>
        </div>
        <div class="alert-card">
            <div class="alert-card-head azul">üëÄ ATEN√á√ÉO <span class="badge">${atencao.length}</span></div>
            <div class="alert-card-body">${atencao.length ? atencao.map(p => `<div class="alert-proj azul" onclick="abrirModal('${p.nome}')">${p.nome}<span class="dias">${p.progresso}%</span></div>`).join("") : '<div class="alert-empty">Nenhum</div>'}</div>
        </div>`;
}

// ===== RENDER PROJETOS (com risco + ordena√ß√£o) =====
function renderProjetos() {
    let pf = getProjetosFiltrados();
    
    // Filtro por KPI de risco
    if (filtroRiscoAtivo) {
        const nc = pf.filter(p => p.status !== "Conclu√≠do");
        if (filtroRiscoAtivo === 'noprazo') {
            pf = nc.filter(p => { const al = getAlertaGoLive(p); return al.tipo === "ok" && p.status !== "Atrasado"; });
        } else if (filtroRiscoAtivo === 'golive') {
            pf = nc.filter(p => { const al = getAlertaGoLive(p); return al.tipo === "atrasado" || al.tipo === "proximo"; });
        } else if (filtroRiscoAtivo === 'infra') {
            pf = nc.filter(p => isAlertaInfra(p));
        } else if (filtroRiscoAtivo === 'criticos') {
            pf = nc.filter(p => calcRisco(p).nivel === "alto");
        }
    }
    
    // Ordenar por risco (maior primeiro)
    pf.sort((a, b) => calcRisco(b).score - calcRisco(a).score);
    
    document.getElementById("projetosCount").textContent = pf.length;
    
    // Atualizar label do filtro ativo
    const labels = { noprazo: '‚úÖ Filtro: No Prazo', golive: '‚ö†Ô∏è Filtro: Go Lives em Risco', infra: 'üîß Filtro: Alertas Infra', criticos: 'üö® Filtro: Cr√≠ticos' };
    const labelEl = document.getElementById("filtroAtivoLabel");
    if (filtroRiscoAtivo) {
        labelEl.innerHTML = `<span style="background:#eef2ff;color:#4338ca;padding:3px 10px;border-radius:12px;font-weight:600">${labels[filtroRiscoAtivo]} <span onclick="filtrarRisco('${filtroRiscoAtivo}')" style="cursor:pointer;margin-left:4px">‚úï</span></span>`;
    } else {
        labelEl.textContent = 'Ordenados por n√≠vel de risco';
        labelEl.style.color = '#94a3b8';
    }
    
    document.getElementById("projetosGrid").innerHTML = pf.map(p => {
        const cor = getCorProgresso(p.progresso);
        const al = getAlertaGoLive(p);
        const glc = al.tipo === "atrasado" ? "atrasado" : al.tipo === "proximo" ? "proximo" : "";
        const risco = calcRisco(p);
        const temAlerta = isAlertaInfra(p);
        
        return `<div class="project-card ${cor}" onclick="abrirModal('${p.nome}')">
            <div class="project-header">
                <span class="project-name">${p.nome}</span>
                <div class="project-badges">
                    ${risco.nivel !== "ok" ? `<span class="risk-badge ${risco.nivel}">${risco.label}</span>` : ""}
                    <span class="priority ${p.prioridade.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}">${p.prioridade}</span>
                    ${temAlerta ? '<span class="alert-badge-tag">‚ö° ALERTA</span>' : ""}
                </div>
            </div>
            <div class="project-meta"><span>üìç ${p.local}</span><span>üë§ ${p.pmo}</span></div>
            <div class="project-phase">${p.fase}</div>
            <div class="progress">
                <div class="progress-header"><span>Progresso</span><strong>${p.progresso}%</strong></div>
                <div class="progress-bar"><div class="progress-fill ${cor}" style="width:${p.progresso}%"></div></div>
            </div>
            <div class="project-footer">
                <span class="status-badge ${getStatusClass(p.status)}">${p.status}</span>
                <span class="go-live-info ${glc}">Go Live: ${formatDate(p.goLive) || "A definir"}</span>
            </div>
        </div>`;
    }).join("") || '<div class="alert-empty">Nenhum projeto encontrado</div>';
}

// ===== FILTROS =====
let filtroRiscoAtivo = '';

function filtrarRisco(tipo) {
    // Toggle: clicou no mesmo = limpa filtro
    if (filtroRiscoAtivo === tipo) {
        filtroRiscoAtivo = '';
    } else {
        filtroRiscoAtivo = tipo;
    }
    // Limpar filtros normais ao usar filtro de risco
    ["filtroNome","filtroStatus","filtroPrioridade","filtroPMO"].forEach(id => document.getElementById(id).value = "");
    // Visual: marcar KPI ativo
    document.querySelectorAll('.risk-kpi').forEach(el => el.classList.remove('active'));
    if (filtroRiscoAtivo) {
        const ids = { noprazo: 'kpiNoPrazo', golive: 'kpiGoLive', infra: 'kpiInfra', criticos: 'kpiCriticos' };
        document.getElementById(ids[filtroRiscoAtivo])?.classList.add('active');
    }
    renderAll();
    // Scroll at√© a lista de projetos
    document.getElementById("projetosGrid").scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function filtrarStatus(s) { filtroRiscoAtivo = ''; document.querySelectorAll('.risk-kpi').forEach(el => el.classList.remove('active')); document.getElementById("filtroStatus").value = s; renderAll(); }
function filtrarPrioridade(p) { filtroRiscoAtivo = ''; document.querySelectorAll('.risk-kpi').forEach(el => el.classList.remove('active')); document.getElementById("filtroPrioridade").value = p; renderAll(); }
function filtrarPMO(m) { filtroRiscoAtivo = ''; document.querySelectorAll('.risk-kpi').forEach(el => el.classList.remove('active')); document.getElementById("filtroPMO").value = m; renderAll(); }
function renderAll() { renderAlertasGoLive(); renderAlertasInfra(); renderProjetos(); }
function limparFiltros() {
    filtroRiscoAtivo = '';
    document.querySelectorAll('.risk-kpi').forEach(el => el.classList.remove('active'));
    ["filtroNome","filtroStatus","filtroPrioridade","filtroPMO"].forEach(id => document.getElementById(id).value = "");
    renderAll();
}

// ===== MODAL =====
function abrirModal(nome) {
    const p = PROJETOS.find(x => x.nome === nome);
    if (!p) return;
    const al = getAlertaGoLive(p);
    const risco = calcRisco(p);
    
    document.getElementById("modalTitle").textContent = "üìã " + p.nome;
    document.getElementById("modalBody").innerHTML = `
        <div class="modal-info">
            <div class="modal-info-item"><span class="label">Status</span><div class="value">${p.status}</div></div>
            <div class="modal-info-item"><span class="label">Fase</span><div class="value">${p.fase}</div></div>
            <div class="modal-info-item"><span class="label">Progresso</span><div class="value">${p.progresso}%</div></div>
            <div class="modal-info-item"><span class="label">Prioridade</span><div class="value">${p.prioridade}</div></div>
            <div class="modal-info-item"><span class="label">PMO</span><div class="value">${p.pmo}</div></div>
            <div class="modal-info-item"><span class="label">Local</span><div class="value">${p.local}</div></div>
            <div class="modal-info-item"><span class="label">Go Live</span><div class="value">${formatDate(p.goLive) || "A definir"}</div></div>
            <div class="modal-info-item"><span class="label">Dias p/ Go Live</span><div class="value">${al.dias !== null ? al.dias + "d" : "-"}</div></div>
            <div class="modal-info-item"><span class="label">N√≠vel de Risco</span><div class="value">${risco.label || "‚úÖ Sem risco"}</div></div>
            <div class="modal-info-item"><span class="label">Score de Risco</span><div class="value">${risco.score} pts</div></div>
        </div>
        <div class="modal-obs"><strong>üìù Observa√ß√µes</strong><p>${p.obs}</p></div>`;
    document.getElementById("modal").classList.add("show");
}
function fecharModal() { document.getElementById("modal").classList.remove("show"); }

// ===== INICIALIZA√á√ÉO =====
document.getElementById("dataAtual").textContent = hoje.toLocaleDateString("pt-BR");
renderRiskKPIs();
renderPrioridade();
renderPMO();
renderAlertasGoLive();
renderAlertasInfra();
renderProjetos();
document.addEventListener("keydown", e => { if (e.key === "Escape") fecharModal(); });
</script>
</body>
</html>
