<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vis√£o Detalhada - Infraestrutura v7.5</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f1f5f9; min-height: 100vh; }
        
        .header { background: linear-gradient(135deg, #1e293b 0%, #334155 100%); color: white; padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; }
        .header-left h1 { font-size: 1.2em; display: flex; align-items: center; gap: 10px; }
        .version { background: #22c55e; padding: 4px 12px; border-radius: 12px; font-size: 0.7em; font-weight: 600; }
        .timestamp { font-size: 0.8em; opacity: 0.8; margin-top: 5px; }
        
        .nav-buttons { display: flex; gap: 8px; flex-wrap: wrap; }
        .nav-btn { padding: 9px 16px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.85em; transition: all 0.2s; text-decoration: none; display: inline-flex; align-items: center; gap: 5px; }
        .nav-btn.blue { background: #3b82f6; color: white; }
        .nav-btn.purple { background: #8b5cf6; color: white; }
        .nav-btn.red { background: #ef4444; color: white; }
        .nav-btn.gray { background: #6b7280; color: white; }
        .nav-btn:hover { filter: brightness(1.1); }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        
        .phases-legend { background: white; padding: 10px 15px; border-radius: 8px; margin-bottom: 15px; font-size: 0.75em; color: #64748b; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.06); }
        .phases-legend strong { color: #475569; }
        
        .kpis { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin-bottom: 25px; }
        .kpi { background: white; padding: 18px 15px; border-radius: 10px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.06); border-left: 4px solid #e2e8f0; }
        .kpi.verde { border-left-color: #22c55e; }
        .kpi.amarelo { border-left-color: #f59e0b; }
        .kpi.vermelho { border-left-color: #ef4444; }
        .kpi.azul { border-left-color: #3b82f6; }
        .kpi .num { font-size: 2em; font-weight: 700; color: #1e293b; }
        .kpi .lbl { font-size: 0.85em; color: #64748b; margin-top: 3px; }
        
        .status-section { margin-bottom: 30px; }
        .status-header { display: flex; align-items: center; gap: 12px; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #e2e8f0; }
        .status-dot { width: 14px; height: 14px; border-radius: 50%; }
        .status-dot.concluido { background: #22c55e; }
        .status-dot.em-andamento { background: #3b82f6; }
        .status-dot.aguardando { background: #f59e0b; }
        .status-dot.nao-iniciado { background: #94a3b8; }
        .status-dot.atrasado { background: #ef4444; }
        .status-title { font-size: 1.15em; font-weight: 600; color: #1e293b; }
        .status-count { background: #e2e8f0; color: #475569; padding: 4px 12px; border-radius: 20px; font-size: 0.85em; font-weight: 600; }
        
        .projects-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)); gap: 15px; }
        
        .project-card { background: white; border-radius: 10px; padding: 18px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); cursor: pointer; transition: all 0.2s; border-left: 4px solid #e2e8f0; }
        .project-card:hover { box-shadow: 0 8px 25px rgba(0,0,0,0.1); transform: translateY(-2px); }
        .project-card.concluido { border-left-color: #22c55e; }
        .project-card.em-andamento { border-left-color: #3b82f6; }
        .project-card.aguardando { border-left-color: #f59e0b; }
        .project-card.nao-iniciado { border-left-color: #94a3b8; }
        .project-card.atrasado { border-left-color: #ef4444; }
        
        .project-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px; }
        .project-name { font-size: 1.1em; font-weight: 700; color: #1e293b; }
        .priority { padding: 3px 8px; border-radius: 4px; font-size: 0.7em; font-weight: 700; text-transform: uppercase; }
        .priority.alta { background: #fee2e2; color: #dc2626; }
        .priority.media { background: #fef3c7; color: #d97706; }
        .priority.baixa { background: #dcfce7; color: #16a34a; }
        
        .project-meta { display: flex; flex-wrap: wrap; gap: 12px; font-size: 0.85em; color: #64748b; margin-bottom: 10px; }
        .project-phase { background: #eff6ff; color: #1d4ed8; padding: 5px 10px; border-radius: 6px; font-size: 0.8em; margin-bottom: 10px; display: inline-block; }
        
        .project-dates { display: flex; gap: 12px; font-size: 0.8em; color: #64748b; margin-bottom: 10px; flex-wrap: wrap; }
        .project-dates .atrasado { color: #dc2626; font-weight: 600; }
        
        .progress-bar { height: 8px; background: #e2e8f0; border-radius: 4px; overflow: hidden; margin-bottom: 8px; }
        .progress-fill { height: 100%; border-radius: 4px; }
        .progress-fill.verde { background: #22c55e; }
        .progress-fill.amarelo { background: #f59e0b; }
        .progress-fill.vermelho { background: #ef4444; }
        
        .progress-text { font-size: 0.85em; color: #64748b; }
        .progress-text strong { color: #1e293b; }
        
        .empty { text-align: center; padding: 30px; color: #94a3b8; background: white; border-radius: 10px; }
        
        .modal-bg { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center; padding: 20px; }
        .modal-bg.show { display: flex; }
        .modal { background: white; border-radius: 12px; max-width: 750px; width: 100%; max-height: 85vh; overflow: hidden; }
        .modal-head { background: #667eea; color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; }
        .modal-head h2 { font-size: 1.1em; }
        .modal-close { background: rgba(255,255,255,0.2); border: none; color: white; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; font-size: 1.2em; }
        .modal-body { padding: 20px; max-height: calc(85vh - 60px); overflow-y: auto; }
        
        .modal-info { display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #e2e8f0; }
        .modal-info-item { font-size: 0.9em; color: #64748b; }
        .modal-info-item strong { color: #1e293b; }
        
        .modal-milestone { background: #eff6ff; border: 1px solid #bfdbfe; padding: 12px 15px; border-radius: 8px; margin-bottom: 15px; }
        .modal-milestone-title { font-size: 0.8em; color: #1d4ed8; font-weight: 600; margin-bottom: 5px; }
        .modal-milestone-content { font-size: 0.9em; color: #1e293b; }
        
        .summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 15px; }
        .summary-item { text-align: center; padding: 12px 8px; background: #f8fafc; border-radius: 8px; }
        .summary-item .num { font-size: 1.4em; font-weight: 700; }
        .summary-item .lbl { font-size: 0.75em; color: #64748b; }
        
        .activity-list { border: 1px solid #e2e8f0; border-radius: 8px; }
        .activity { display: grid; grid-template-columns: 1fr auto auto; gap: 10px; align-items: center; padding: 10px 12px; border-bottom: 1px solid #e2e8f0; }
        .activity:last-child { border-bottom: none; }
        .activity:nth-child(even) { background: #f8fafc; }
        .activity-info { min-width: 0; }
        .activity-name { font-size: 0.9em; color: #1e293b; font-weight: 500; }
        .activity-fase { font-size: 0.75em; color: #64748b; }
        .activity-dates { font-size: 0.75em; color: #94a3b8; }
        .activity-resp { font-size: 0.75em; color: #64748b; text-align: right; min-width: 80px; }
        .status-badge { padding: 3px 8px; border-radius: 4px; font-size: 0.75em; font-weight: 600; }
        .status-badge.concluido { background: #dcfce7; color: #166534; }
        .status-badge.em-andamento { background: #dbeafe; color: #1e40af; }
        .status-badge.aguardando { background: #fef3c7; color: #92400e; }
        .status-badge.nao-iniciado { background: #f3f4f6; color: #4b5563; }
        
        @media (max-width: 768px) {
            .header { flex-direction: column; text-align: center; }
            .nav-buttons { justify-content: center; }
            .projects-grid { grid-template-columns: 1fr; }
            .summary { grid-template-columns: repeat(2, 1fr); }
        }
        
        @media print {
            body { background: white !important; }
            .header { background: #1e293b !important; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
            .nav-buttons { display: none !important; }
            .container { max-width: 100% !important; padding: 15px !important; }
            .phases-legend { box-shadow: none !important; border: 1px solid #e2e8f0 !important; }
            .kpi { box-shadow: none !important; border: 1px solid #e2e8f0 !important; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
            .project-card { box-shadow: none !important; border: 1px solid #e2e8f0 !important; break-inside: avoid !important; page-break-inside: avoid !important; margin-bottom: 10px !important; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
            .projects-grid { display: block !important; }
            .progress-fill { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
            .status-dot { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-left">
            <h1>üìã Vis√£o Detalhada - Infraestrutura <span class="version">v7.5</span></h1>
            <div class="timestamp" id="timestamp"></div>
        </div>
        <nav class="nav-buttons">
            <a href="index.html" class="nav-btn blue">üè† In√≠cio</a>
            <button class="nav-btn purple" onclick="window.print()">üñ®Ô∏è Imprimir</button>
            <button class="nav-btn red" onclick="gerarPDF()">üìÑ Gerar PDF</button>
            <a href="admin.html" class="nav-btn gray">‚öôÔ∏è Admin</a>
        </nav>
    </header>
    
    <main class="container">
        <div class="phases-legend">
            <strong>Fases:</strong> 1. Inicia√ß√£o ¬∑ 2. Planejamento & Documenta√ß√£o ¬∑ 3. Provisionamento ¬∑ 4. Implementa√ß√£o ¬∑ 5. Testes & Homologa√ß√£o ¬∑ 6. Deploy ¬∑ 7. Estabiliza√ß√£o ¬∑ 8. Encerramento
        </div>
        <div class="kpis" id="kpis"></div>
        <div id="content"></div>
    </main>
    
    <div class="modal-bg" id="modal" onclick="fecharModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-head">
                <h2 id="modalTitle">Atividades</h2>
                <button class="modal-close" onclick="fecharModal()">√ó</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

<script>
const PROJETOS = [
    { nome: 'COUGAR', local: 'S√£o Paulo', resp: 'Maria Silva', prioridade: 'Alta', dataInicio: '2025-10-01', dataPrevista: '2026-03-15' },
    { nome: 'BETA', local: 'Rio de Janeiro', resp: 'Jo√£o Santos', prioridade: 'Alta', dataInicio: '2025-11-15', dataPrevista: '2026-04-01' },
    { nome: 'NAVEPARK', local: 'Curitiba', resp: 'Ana Costa', prioridade: 'M√©dia', dataInicio: '2025-06-01', dataPrevista: '2026-01-10' },
    { nome: 'ESPERAN√áA', local: 'Belo Horizonte', resp: 'Carlos Lima', prioridade: 'M√©dia', dataInicio: '2025-12-01', dataPrevista: '2026-05-20' },
    { nome: 'PBL GUATEMALA', local: 'Guatemala', resp: 'Pedro Souza', prioridade: 'Baixa', dataInicio: '2026-01-15', dataPrevista: '2026-06-01' },
    { nome: 'CRISTAL MG', local: 'Belo Horizonte', resp: 'Maria Silva', prioridade: 'Alta', dataInicio: '2025-09-01', dataPrevista: '2026-01-20' }
];
const FASES = ['1. Inicia√ß√£o','2. Planejamento & Documenta√ß√£o','3. Provisionamento de Recursos','4. Implementa√ß√£o','5. Testes & Homologa√ß√£o','6. Deploy em Produ√ß√£o','7. Estabiliza√ß√£o','8. Encerramento'];
const ATIVIDADES = [
    {proj:'COUGAR',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-01',dataFim:'2025-10-05',resp:'Maria Silva'},
    {proj:'COUGAR',nome:'Documenta√ß√£o Layout',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-06',dataFim:'2025-10-20',resp:'Ana Costa'},
    {proj:'COUGAR',nome:'Solicita√ß√£o VPN',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-10-21',dataFim:'2025-11-05',resp:'Jo√£o Santos'},
    {proj:'COUGAR',nome:'Solicita√ß√£o IPs',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-10-21',dataFim:'2025-11-05',resp:'Jo√£o Santos'},
    {proj:'COUGAR',nome:'Instala√ß√£o Equipamentos',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-11-10',dataFim:'2025-12-01',resp:'Pedro Souza'},
    {proj:'COUGAR',nome:'Configura√ß√£o Rede',fase:'4. Implementa√ß√£o',status:'Em andamento',dataInicio:'2025-12-05',dataFim:'2026-01-15',resp:'Carlos Lima'},
    {proj:'COUGAR',nome:'Testes Homologa√ß√£o',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-01-20',dataFim:'2026-02-10',resp:'Maria Silva'},
    {proj:'COUGAR',nome:'Deploy Produ√ß√£o',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-02-15',dataFim:'2026-02-28',resp:'Jo√£o Santos'},
    {proj:'COUGAR',nome:'Monitoramento',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-03-01',dataFim:'2026-03-10',resp:'Ana Costa'},
    {proj:'COUGAR',nome:'Aceite Formal',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-03-11',dataFim:'2026-03-15',resp:'Maria Silva'},
    {proj:'BETA',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-11-15',dataFim:'2025-11-20',resp:'Jo√£o Santos'},
    {proj:'BETA',nome:'Documenta√ß√£o Layout',fase:'2. Planejamento & Documenta√ß√£o',status:'Em andamento',dataInicio:'2025-11-25',dataFim:'2026-01-10',resp:'Ana Costa'},
    {proj:'BETA',nome:'Solicita√ß√£o VPN',fase:'3. Provisionamento de Recursos',status:'N√£o Iniciado',dataInicio:'2026-01-15',dataFim:'2026-02-01',resp:'Carlos Lima'},
    {proj:'BETA',nome:'Instala√ß√£o Equipamentos',fase:'4. Implementa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-02-05',dataFim:'2026-02-28',resp:'Pedro Souza'},
    {proj:'BETA',nome:'Testes Homologa√ß√£o',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-03-01',dataFim:'2026-03-15',resp:'Maria Silva'},
    {proj:'BETA',nome:'Deploy Produ√ß√£o',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-03-16',dataFim:'2026-03-25',resp:'Jo√£o Santos'},
    {proj:'BETA',nome:'Monitoramento',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-03-26',dataFim:'2026-03-30',resp:'Ana Costa'},
    {proj:'BETA',nome:'Aceite Formal',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-03-31',dataFim:'2026-04-01',resp:'Jo√£o Santos'},
    {proj:'NAVEPARK',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-06-01',dataFim:'2025-06-05',resp:'Ana Costa'},
    {proj:'NAVEPARK',nome:'Documenta√ß√£o Layout',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-06-10',dataFim:'2025-07-01',resp:'Maria Silva'},
    {proj:'NAVEPARK',nome:'Solicita√ß√£o VPN',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-07-05',dataFim:'2025-07-20',resp:'Jo√£o Santos'},
    {proj:'NAVEPARK',nome:'Instala√ß√£o Equipamentos',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-07-25',dataFim:'2025-09-01',resp:'Pedro Souza'},
    {proj:'NAVEPARK',nome:'Testes Homologa√ß√£o',fase:'5. Testes & Homologa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-09-05',dataFim:'2025-10-01',resp:'Carlos Lima'},
    {proj:'NAVEPARK',nome:'Deploy Produ√ß√£o',fase:'6. Deploy em Produ√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-05',dataFim:'2025-10-20',resp:'Ana Costa'},
    {proj:'NAVEPARK',nome:'Monitoramento',fase:'7. Estabiliza√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-25',dataFim:'2025-12-01',resp:'Maria Silva'},
    {proj:'NAVEPARK',nome:'Aceite Formal',fase:'8. Encerramento',status:'Conclu√≠do',dataInicio:'2025-12-05',dataFim:'2026-01-10',resp:'Ana Costa'},
    {proj:'ESPERAN√áA',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Aguardando',dataInicio:'2025-12-01',dataFim:'2025-12-10',resp:'Carlos Lima'},
    {proj:'ESPERAN√áA',nome:'Documenta√ß√£o Layout',fase:'2. Planejamento & Documenta√ß√£o',status:'N√£o Iniciado',dataInicio:'2025-12-15',dataFim:'2026-01-15',resp:'Ana Costa'},
    {proj:'ESPERAN√áA',nome:'Solicita√ß√£o VPN',fase:'3. Provisionamento de Recursos',status:'N√£o Iniciado',dataInicio:'2026-01-20',dataFim:'2026-02-10',resp:'Jo√£o Santos'},
    {proj:'ESPERAN√áA',nome:'Instala√ß√£o Equipamentos',fase:'4. Implementa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-02-15',dataFim:'2026-03-15',resp:'Pedro Souza'},
    {proj:'ESPERAN√áA',nome:'Testes Homologa√ß√£o',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-03-20',dataFim:'2026-04-10',resp:'Maria Silva'},
    {proj:'ESPERAN√áA',nome:'Deploy Produ√ß√£o',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-04-15',dataFim:'2026-04-30',resp:'Carlos Lima'},
    {proj:'ESPERAN√áA',nome:'Monitoramento',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-05-01',dataFim:'2026-05-15',resp:'Ana Costa'},
    {proj:'ESPERAN√áA',nome:'Aceite Formal',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-05-16',dataFim:'2026-05-20',resp:'Carlos Lima'},
    {proj:'PBL GUATEMALA',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-01-15',dataFim:'2026-01-20',resp:'Pedro Souza'},
    {proj:'PBL GUATEMALA',nome:'Documenta√ß√£o Layout',fase:'2. Planejamento & Documenta√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-01-25',dataFim:'2026-02-15',resp:'Ana Costa'},
    {proj:'PBL GUATEMALA',nome:'Solicita√ß√£o VPN',fase:'3. Provisionamento de Recursos',status:'N√£o Iniciado',dataInicio:'2026-02-20',dataFim:'2026-03-10',resp:'Jo√£o Santos'},
    {proj:'PBL GUATEMALA',nome:'Instala√ß√£o Equipamentos',fase:'4. Implementa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-03-15',dataFim:'2026-04-15',resp:'Pedro Souza'},
    {proj:'PBL GUATEMALA',nome:'Testes Homologa√ß√£o',fase:'5. Testes & Homologa√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-04-20',dataFim:'2026-05-10',resp:'Maria Silva'},
    {proj:'PBL GUATEMALA',nome:'Deploy Produ√ß√£o',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-05-15',dataFim:'2026-05-25',resp:'Carlos Lima'},
    {proj:'PBL GUATEMALA',nome:'Monitoramento',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-05-26',dataFim:'2026-05-30',resp:'Ana Costa'},
    {proj:'PBL GUATEMALA',nome:'Aceite Formal',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-05-31',dataFim:'2026-06-01',resp:'Pedro Souza'},
    {proj:'CRISTAL MG',nome:'KICKOFF INTERNO',fase:'1. Inicia√ß√£o',status:'Conclu√≠do',dataInicio:'2025-09-01',dataFim:'2025-09-05',resp:'Maria Silva'},
    {proj:'CRISTAL MG',nome:'Documenta√ß√£o Layout',fase:'2. Planejamento & Documenta√ß√£o',status:'Conclu√≠do',dataInicio:'2025-09-10',dataFim:'2025-09-30',resp:'Ana Costa'},
    {proj:'CRISTAL MG',nome:'Solicita√ß√£o VPN',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-10-01',dataFim:'2025-10-15',resp:'Jo√£o Santos'},
    {proj:'CRISTAL MG',nome:'Solicita√ß√£o IPs',fase:'3. Provisionamento de Recursos',status:'Conclu√≠do',dataInicio:'2025-10-01',dataFim:'2025-10-15',resp:'Jo√£o Santos'},
    {proj:'CRISTAL MG',nome:'Instala√ß√£o Equipamentos',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-10-20',dataFim:'2025-11-15',resp:'Pedro Souza'},
    {proj:'CRISTAL MG',nome:'Configura√ß√£o Rede',fase:'4. Implementa√ß√£o',status:'Conclu√≠do',dataInicio:'2025-11-16',dataFim:'2025-12-01',resp:'Carlos Lima'},
    {proj:'CRISTAL MG',nome:'Testes Homologa√ß√£o',fase:'5. Testes & Homologa√ß√£o',status:'Em andamento',dataInicio:'2025-12-05',dataFim:'2026-01-10',resp:'Maria Silva'},
    {proj:'CRISTAL MG',nome:'Deploy Produ√ß√£o',fase:'6. Deploy em Produ√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-01-12',dataFim:'2026-01-18',resp:'Jo√£o Santos'},
    {proj:'CRISTAL MG',nome:'Monitoramento',fase:'7. Estabiliza√ß√£o',status:'N√£o Iniciado',dataInicio:'2026-01-19',dataFim:'2026-01-25',resp:'Ana Costa'},
    {proj:'CRISTAL MG',nome:'Aceite Formal',fase:'8. Encerramento',status:'N√£o Iniciado',dataInicio:'2026-01-26',dataFim:'2026-01-30',resp:'Maria Silva'}
];

const hoje=new Date();hoje.setHours(0,0,0,0);
function parseDate(s){if(!s)return null;const[y,m,d]=s.split('-').map(Number);return new Date(y,m-1,d)}
function formatDate(s){if(!s)return'-';const[y,m,d]=s.split('-');return`${d}/${m}/${y}`}
function diasAtraso(dp){const p=parseDate(dp);if(!p)return 0;const d=Math.floor((hoje-p)/(1000*60*60*24));return d>0?d:0}
function getAtividades(p){return ATIVIDADES.filter(a=>a.proj===p)}
function calcProgresso(p){const a=getAtividades(p);if(!a.length)return 0;return Math.round(a.filter(x=>x.status==='Conclu√≠do').length/a.length*100)}
function calcStatus(p){const pr=PROJETOS.find(x=>x.nome===p),pg=calcProgresso(p);if(pg===100)return'Conclu√≠do';if(pr&&diasAtraso(pr.dataPrevista)>0&&pg<100)return'Atrasado';if(pg===0){const a=getAtividades(p);if(a.some(x=>x.status==='Aguardando'))return'Aguardando';return'N√£o Iniciado'}const a=getAtividades(p);if(a.some(x=>x.status==='Em andamento'))return'Em andamento';if(a.some(x=>x.status==='Aguardando'))return'Aguardando';return'Em andamento'}
function calcFaseAtual(p){const a=getAtividades(p);if(!a.length)return FASES[0];if(a.every(x=>x.status==='Conclu√≠do'))return FASES[7];for(const f of FASES){const af=a.filter(x=>x.fase===f);if(af.some(x=>x.status==='Em andamento'))return f}for(const f of FASES){const af=a.filter(x=>x.fase===f);if(af.some(x=>x.status==='Aguardando'))return f}for(const f of FASES){const af=a.filter(x=>x.fase===f);if(af.length&&!af.every(x=>x.status==='Conclu√≠do'))return f}return FASES[0]}
function calcProximaMilestone(p){const a=getAtividades(p).filter(x=>x.status!=='Conclu√≠do').sort((a,b)=>parseDate(a.dataInicio)-parseDate(b.dataInicio));return a.length?a[0]:null}
function getCor(pct){return pct>=100?'verde':pct>=50?'amarelo':'vermelho'}
function getStatusClass(s){return s.toLowerCase().replace(/ /g,'-').replace('√£','a')}

function renderKPIs(){const t=PROJETOS.length,c=PROJETOS.filter(p=>calcStatus(p.nome)==='Conclu√≠do').length,e=PROJETOS.filter(p=>calcStatus(p.nome)==='Em andamento').length,ag=PROJETOS.filter(p=>calcStatus(p.nome)==='Aguardando').length,at=PROJETOS.filter(p=>calcStatus(p.nome)==='Atrasado').length;document.getElementById('kpis').innerHTML=`<div class="kpi azul"><div class="num">${t}</div><div class="lbl">Total</div></div><div class="kpi verde"><div class="num">${c}</div><div class="lbl">Conclu√≠dos</div></div><div class="kpi amarelo"><div class="num">${e}</div><div class="lbl">Em Andamento</div></div><div class="kpi amarelo"><div class="num">${ag}</div><div class="lbl">Aguardando</div></div><div class="kpi vermelho"><div class="num">${at}</div><div class="lbl">Atrasados</div></div>`}

function render(){renderKPIs();const so=['Atrasado','Em andamento','Aguardando','N√£o Iniciado','Conclu√≠do'],ps={};so.forEach(s=>ps[s]=[]);PROJETOS.forEach(p=>{const s=calcStatus(p.nome);if(ps[s])ps[s].push(p)});let h='';so.forEach(s=>{const pjs=ps[s];if(!pjs.length)return;h+=`<section class="status-section"><div class="status-header"><span class="status-dot ${getStatusClass(s)}"></span><span class="status-title">${s}</span><span class="status-count">${pjs.length} projeto${pjs.length>1?'s':''}</span></div><div class="projects-grid">${pjs.map(p=>{const pg=calcProgresso(p.nome),fa=calcFaseAtual(p.nome),cor=getCor(pg),at=diasAtraso(p.dataPrevista);return`<div class="project-card ${getStatusClass(s)}" onclick="abrirModal('${p.nome}')"><div class="project-header"><span class="project-name">${p.nome}</span><span class="priority ${p.prioridade.toLowerCase()}">${p.prioridade}</span></div><div class="project-meta"><span>üìç ${p.local}</span><span>üë§ ${p.resp}</span></div><span class="project-phase">üìò Fase: ${fa}</span><div class="project-dates"><span>üéØ Previsto: ${formatDate(p.dataPrevista)}</span>${at>0&&pg<100?`<span class="atrasado">‚ö†Ô∏è ${at} dias atraso</span>`:''}</div><div class="progress-bar"><div class="progress-fill ${cor}" style="width:${pg}%"></div></div><div class="progress-text">Progresso: <strong>${pg}%</strong></div></div>`}).join('')}</div></section>`});document.getElementById('content').innerHTML=h||'<div class="empty">Nenhum projeto encontrado</div>';document.getElementById('timestamp').textContent='Atualizado em: '+new Date().toLocaleString('pt-BR')}

function abrirModal(proj){const p=PROJETOS.find(x=>x.nome===proj),a=getAtividades(proj),pg=calcProgresso(proj),fa=calcFaseAtual(proj),pm=calcProximaMilestone(proj),st=calcStatus(proj),at=diasAtraso(p?.dataPrevista),dn=a.filter(x=>x.status==='Conclu√≠do').length,do_=a.filter(x=>x.status==='Em andamento').length,wa=a.filter(x=>x.status==='Aguardando').length,ns=a.filter(x=>x.status==='N√£o Iniciado').length;document.getElementById('modalTitle').textContent=`üìã ${proj}`;let mh='';if(pm)mh=`<div class="modal-milestone"><div class="modal-milestone-title">üéØ Pr√≥xima Milestone</div><div class="modal-milestone-content">${pm.nome} ‚Äì ${formatDate(pm.dataInicio)}</div></div>`;document.getElementById('modalBody').innerHTML=`<div class="modal-info"><span class="modal-info-item"><strong>Local:</strong> ${p?.local||'-'}</span><span class="modal-info-item"><strong>Respons√°vel:</strong> ${p?.resp||'-'}</span><span class="modal-info-item"><strong>Prioridade:</strong> ${p?.prioridade||'-'}</span><span class="modal-info-item"><strong>In√≠cio:</strong> ${formatDate(p?.dataInicio)}</span><span class="modal-info-item"><strong>Previsto:</strong> ${formatDate(p?.dataPrevista)}</span>${at>0&&pg<100?`<span class="modal-info-item" style="color:#dc2626"><strong>‚ö†Ô∏è Atraso:</strong> ${at} dias</span>`:''}</div>${mh}<div class="summary"><div class="summary-item"><div class="num" style="color:#22c55e">${dn}</div><div class="lbl">Conclu√≠das</div></div><div class="summary-item"><div class="num" style="color:#3b82f6">${do_}</div><div class="lbl">Em andamento</div></div><div class="summary-item"><div class="num" style="color:#f59e0b">${wa}</div><div class="lbl">Aguardando</div></div><div class="summary-item"><div class="num" style="color:#6b7280">${ns}</div><div class="lbl">N√£o iniciadas</div></div></div><p style="margin-bottom:12px;color:#64748b"><strong>Fase atual:</strong> ${fa} | <strong>Progresso:</strong> ${pg}%</p><div class="activity-list">${a.map(x=>`<div class="activity"><div class="activity-info"><div class="activity-name">${x.nome}</div><div class="activity-fase">${x.fase}</div><div class="activity-dates">üìÖ ${formatDate(x.dataInicio)} ‚Üí ${formatDate(x.dataFim)}</div></div><div class="activity-resp">üë§ ${x.resp}</div><span class="status-badge ${getStatusClass(x.status)}">${x.status}</span></div>`).join('')}</div>`;document.getElementById('modal').classList.add('show')}
function fecharModal(e){if(!e||e.target.id==='modal')document.getElementById('modal').classList.remove('show')}
function gerarPDF(){window.print()}
document.addEventListener('keydown',e=>{if(e.key==='Escape')fecharModal()});
window.addEventListener('DOMContentLoaded',render);
</script>
</body>
</html>
